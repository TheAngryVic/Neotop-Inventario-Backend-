"use strict";(self["webpackChunkfront_inventario"]=self["webpackChunkfront_inventario"]||[]).push([[205],{6305:(e,o,a)=>{a.d(o,{Z:()=>S});var l=a(3673),t=a(8880);const s=e=>((0,l.dD)("data-v-56b5c116"),e=e(),(0,l.Cn)(),e),n={id:"app"},r=s((()=>(0,l._)("h5",null,"Carga masiva",-1))),i={class:"row justify-center"};function d(e,o,a,s,d,c){const u=(0,l.up)("q-card-section"),g=(0,l.up)("q-btn"),p=(0,l.up)("vue-csv-toggle-headers"),m=(0,l.up)("vue-csv-errors"),b=(0,l.up)("vue-csv-input"),v=(0,l.up)("vue-csv-map"),f=(0,l.up)("vue-csv-import"),h=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(h,{style:{height:"600px","max-height":"80vh","max-width":"70vw"}},{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[r])),_:1}),(0,l.Wm)(u,{class:"full-width column content-stretch"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:s.csv,"onUpdate:modelValue":o[0]||(o[0]=e=>s.csv=e),fields:s.fields,text:s.texto},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((({hasHeaders:e,toggle:o})=>[(0,l._)("div",i,[(0,l.Wm)(g,{push:"",color:"white","text-color":1==e?"primary":"secondary",label:"Tiene cabecera?",icon:1==e?"las la-times":"las la-check ",onClick:(0,t.iM)(o,["prevent"]),class:"q-my-lg"},null,8,["text-color","icon","onClick"])])])),_:1}),(0,l.Wm)(m),(0,l.Wm)(b),(0,l.Wm)(v),(0,l._)("div",null,[(0,l.Wm)(g,{push:"",color:"white","text-color":"accent",label:"Procesar archivo",onClick:(0,t.iM)(s.procesar,["prevent"]),class:"q-my-lg",disable:s.bloquear},null,8,["onClick","disable"])])])),_:1},8,["modelValue","fields","text"])])),_:1})])),_:1})])}var c=a(1959),u=a(8825),g=a(3739),p=a(5474);const m={components:{VueCsvToggleHeaders:g.H_,VueCsvMap:g.qH,VueCsvInput:g.hX,VueCsvErrors:g.v7,VueCsvImport:g.xD},setup(){const e=(0,u.Z)(),o={headers:{"x-token":localStorage.token}},a=(0,c.iH)(null),t=(0,l.f3)("url"),s=(0,l.f3)("fields"),n=(0,l.f3)("nserie"),r={errors:{fileRequired:"Un archivo es requerido",invalidMimeType:"Tipo de archivo invalido"},toggleHeaders:"Cabecera?   ",submitBtn:"Procesar",fieldColumn:"Campo",csvColumn:"Columna"},i=async()=>{if(n){const o=a.value.reduce(((e,o)=>(e[o.nSerie]=++e[o.nSerie]||0,e)),{}),l=a.value.filter((e=>o[e.nSerie]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nSerie}`})}else{const o=a.value.reduce(((e,o)=>(e[o.nombre]=++e[o.nombre]||0,e)),{});console.log(o);const l=a.value.filter((e=>o[e.nombre]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nombre}`})}await p.api.post(t,a,o).then((o=>{console.log(o),200!=o.status||e.dialog({title:"Exito",message:"Los datos se han cargado con exito "})})).catch((o=>{console.log("Catch ->",o),o&&e.dialog({title:"Error",message:"El archivo tiene datos que no corresponden, por favor revise datos"})}))},d=(0,c.Fl)((()=>null!=a.value?"true":""));return{bloquear:d,csv:a,fields:s,options:o,procesar:i,texto:r}}};var b=a(4260),v=a(151),f=a(5589),h=a(8240),w=a(7518),y=a.n(w);const q=(0,b.Z)(m,[["render",d],["__scopeId","data-v-56b5c116"]]),S=q;y()(m,"components",{QCard:v.Z,QCardSection:f.Z,QBtn:h.Z})},2205:(e,o,a)=>{a.r(o),a.d(o,{default:()=>ae});var l=a(3673),t=a(8880);const s=(0,l._)("div",{class:"row justify-center"},[(0,l._)("h3",null,"Productos")],-1),n={class:"row xs-12 md-9 justify-center"},r={class:"row justify-center q-mt-md"};function i(e,o,a,i,d,c){const u=(0,l.up)("tabla"),g=(0,l.up)("q-btn"),p=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(p,{class:"q-p2"},{default:(0,l.w5)((()=>[s,(0,l._)("div",n,[(0,l.Wm)(u,{cols:d.cols,tittle:"Listado de productos (Mantenedor)"},null,8,["cols"])]),(0,l._)("div",r,[(0,l.Wm)(g,{color:"secondary",icon:"las la-check",label:"Agregar",onClick:(0,t.iM)(d.toggleAgregar,["prevent"])},null,8,["onClick"]),(0,l.Wm)(g,{color:"accent",icon:"las la-paperclip",label:"Carga masiva",onClick:(0,t.iM)(d.toggleMasivo,["prevent"]),class:"q-mx-md"},null,8,["onClick"])])])),_:1})}var d=a(1959),c=a(5474),u=a(2323);const g={class:"full-width row flex-center text-accent q-gutter-sm"};function p(e,o,a,t,s,n){const r=(0,l.up)("q-icon"),i=(0,l.up)("q-input"),d=(0,l.up)("q-btn"),c=(0,l.up)("q-td"),p=(0,l.up)("q-table"),m=(0,l.up)("agregarProducto"),b=(0,l.up)("q-dialog"),v=(0,l.up)("editarProducto"),f=(0,l.up)("masivo");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(p,{columns:a.cols,filter:t.filter,loading:t.loading,"rows-per-page-options":[5,8,10],rows:t.productos,title:a.tittle,onRequest:t.onRequest,"card-class":"bg-red-1 text-grey-9",class:"q-mt-xl",color:"primary","row-key":"id","rows-per-page-label":"Filas por página",pagination:t.pagination,"onUpdate:pagination":o[1]||(o[1]=e=>t.pagination=e),"binary-state-sort":""},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(i,{modelValue:t.filter,"onUpdate:modelValue":o[0]||(o[0]=e=>t.filter=e),rounded:"",outlined:"",debounce:"300",placeholder:"buscador","bg-color":"white"},{append:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"las la-search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,l.w5)((e=>[(0,l.Wm)(c,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{dense:"",round:"",flat:"",color:"orange-13",onClick:o=>t.editarProducto(e),icon:"las la-edit"},null,8,["onClick"]),(0,l.Wm)(d,{dense:"",round:"",flat:"",color:"red-14",onClick:o=>t.deleteProducto(e),icon:"las la-trash"},null,8,["onClick"])])),_:2},1032,["props"])])),"no-data":(0,l.w5)((({message:e,filter:o})=>[(0,l._)("div",g,[(0,l.Wm)(r,{size:"2em",name:"las la-meh"}),(0,l._)("span",null," Lamentablemente... "+(0,u.zw)(e),1),(0,l.Wm)(r,{size:"2em",name:o?"las la-frown":"las la-exclamation-triangle"},null,8,["name"])])])),_:1},8,["columns","filter","loading","rows","title","onRequest","pagination"]),(0,l.Wm)(b,{modelValue:t.isVisibleAgregar,"onUpdate:modelValue":o[2]||(o[2]=e=>t.isVisibleAgregar=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isEditVisible,"onUpdate:modelValue":o[3]||(o[3]=e=>t.isEditVisible=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isVisibleMasivo,"onUpdate:modelValue":o[4]||(o[4]=e=>t.isVisibleMasivo=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{onChangeToggle:t.changeToggle},null,8,["onChangeToggle"])])),_:1},8,["modelValue"])],64)}a(71);var m=a(8825);a(8669);const b=e=>{const o=(0,m.Z)(),a={headers:{"x-token":localStorage.token}},l=async()=>{try{let l={modelo:e.Modelo.id,bodega:e.Bodega.id,nSerie:e.nSerie};await c.api.put(`productos/${e.id}`,l,a).then((e=>{console.log(e.data.msg),200===e.status&&o.dialog({title:"Exito al actualizar",message:e.data.msg,cancel:!0})})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&o.dialog({title:"Alerta de repetidos",message:e.response.data.msg})}))}catch(l){console.log(l)}},t=async(e="")=>{try{await c.api["delete"](`productos/${e}`,a).then((e=>{console.log(e),200===e.status&&o.dialog({title:"Exito",message:e.data.msg})})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg})}))}catch(l){console.log(l)}},s=async()=>{let l;try{await c.api.post("productos",e.value,a).then((e=>{console.log(e),201===e.status&&(o.dialog({title:"Exito al agregar",message:e.data.msg}),l=e.data)})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&o.dialog({title:"Alerta",message:e.response.data.msg})}));return l}catch(t){console.log(t)}};return{axiosPut:l,axiosDelete:t,axiosPost:s}},v=b;var f=a(6305);const h={class:"row justify-center"},w=(0,l._)("div",{class:"text-h5 text-primary"},"Agregar Producto",-1),y=(0,l.Uk)(" No results "),q=(0,l.Uk)(" No results ");function S(e,o,a,s,n,r){const i=(0,l.up)("q-card-section"),d=(0,l.up)("q-item-section"),c=(0,l.up)("q-item"),u=(0,l.up)("q-select"),g=(0,l.up)("q-input"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",h,[(0,l.Wm)(b,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{onSubmit:(0,t.iM)(s.agregarModelo,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{filled:"",modelValue:s.producto.modelo,"onUpdate:modelValue":o[0]||(o[0]=e=>s.producto.modelo=e),options:s.modelos,label:"Modelo",style:{width:"250px"},hint:"Seleccione una categoria","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"text-grey"},{default:(0,l.w5)((()=>[y])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l.Wm)(g,{modelValue:s.producto.nSerie,"onUpdate:modelValue":o[1]||(o[1]=e=>s.producto.nSerie=e),filled:"",label:"N° de Serie"},null,8,["modelValue"]),(0,l.Wm)(u,{filled:"",modelValue:s.producto.bodega,"onUpdate:modelValue":o[2]||(o[2]=e=>s.producto.bodega=e),options:s.bodegas,label:"Bodega",style:{width:"250px"},hint:"Seleccione una categoria","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"text-grey"},{default:(0,l.w5)((()=>[q])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l._)("div",null,[(0,l.Wm)(p,{disable:s.bloqued,label:"Agregar",class:"full-width",type:"submit",color:s.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const x={setup(){const e=(0,l.f3)("productosArray"),o=(0,l.f3)("modeloArray"),a=(0,l.f3)("bodegaArray"),t=(0,d.iH)([]),s=(0,d.iH)([]),n=()=>{o.forEach((e=>{let o={label:e.nombre,value:e.id};t.value.push(o)}))};n();const r=()=>{a.forEach((e=>{let o={label:e.nombre,value:e.id};s.value.push(o)}))};r();const i=(0,d.iH)({modelo:"",bodega:"",nSerie:""}),{axiosPost:c}=v(i),u=()=>{let o=c().then((o=>{console.log("Im here"),console.log(o),o&&e.value.push(o.producto)}));const a=e=>{};a(o),i.value={modelo:"",bodega:"",nSerie:""}},g=(0,d.Fl)((()=>!(i.value.modelo&&i.value.bodega&&i.value.nSerie)&&"disable")),p=(0,d.Fl)((()=>"disable"===g.value?"negative":"secondary"));return{agregarModelo:u,bloqued:g,bodegas:s,colorButton:p,modelos:t,producto:i}}};var V=a(4260),W=a(151),_=a(5589),k=a(5269),C=a(4842),Z=a(8516),P=a(3414),A=a(2035),M=a(8240),j=a(7518),Q=a.n(j);const B=(0,V.Z)(x,[["render",S]]),E=B;Q()(x,"components",{QCard:W.Z,QCardSection:_.Z,QForm:k.Z,QInput:C.Z,QSelect:Z.Z,QItem:P.Z,QItemSection:A.Z,QBtn:M.Z});const H={class:"row justify-center"},U=(0,l._)("div",{class:"text-h5 text-primary"},"Modificar Producto",-1),T=(0,l.Uk)(" No results "),I=(0,l.Uk)(" No results ");function J(e,o,a,s,n,r){const i=(0,l.up)("q-card-section"),d=(0,l.up)("q-input"),c=(0,l.up)("q-item-section"),u=(0,l.up)("q-item"),g=(0,l.up)("q-select"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",H,[(0,l.Wm)(b,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[U])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{onSubmit:(0,t.iM)(s.axiosPut,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:s.pObjeto.nSerie,"onUpdate:modelValue":o[0]||(o[0]=e=>s.pObjeto.nSerie=e),filled:"",label:"N° de Serie"},null,8,["modelValue"]),(0,l.Wm)(g,{filled:"",modelValue:s.pObjeto.Modelo.id,"onUpdate:modelValue":o[1]||(o[1]=e=>s.pObjeto.Modelo.id=e),options:s.modelos,label:"Modelo",style:{width:"250px"},hint:"Seleccione un modelo","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"text-grey"},{default:(0,l.w5)((()=>[T])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l.Wm)(g,{filled:"",modelValue:s.pObjeto.Bodega.id,"onUpdate:modelValue":o[2]||(o[2]=e=>s.pObjeto.Bodega.id=e),options:s.bodegas,label:"Bodega",style:{width:"250px"},hint:"Seleccione una bodega","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"text-grey"},{default:(0,l.w5)((()=>[I])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l._)("div",null,[(0,l.Wm)(p,{disable:s.bloqued,label:"Actualizar",class:"full-width",type:"submit",color:s.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const z={props:{objeto:{type:Object,required:!0}},setup(e){const o=(0,l.f3)("modeloArray"),a=(0,l.f3)("bodegaArray"),t=(0,d.iH)([]),s=(0,d.iH)([]),n=()=>{o.forEach((e=>{let o={label:e.nombre,value:e.id};t.value.push(o)}))};n();const r=()=>{a.forEach((e=>{let o={label:e.nombre,value:e.id};s.value.push(o)}))};r();const{axiosPut:i}=v(e.objeto);console.log("prosp",e.objeto.Modelo);const c=(0,d.Fl)((()=>!(e.objeto.Modelo.id&&e.objeto.Bodega.id&&e.objeto.nSerie)&&"disable")),u=(0,d.Fl)((()=>"disable"===c.value?"negative":"warning"));return{axiosPut:i,bloqued:c,bodegas:s,colorButton:u,modelos:t,pObjeto:e.objeto}}},N=(0,V.Z)(z,[["render",J]]),D=N;Q()(z,"components",{QCard:W.Z,QCardSection:_.Z,QForm:k.Z,QInput:C.Z,QSelect:Z.Z,QItem:P.Z,QItemSection:A.Z,QBtn:M.Z});const O={components:{agregarProducto:E,editarProducto:D,masivo:f.Z},props:{tittle:String,cols:Array},setup(e){const o=(0,l.f3)("productosArray"),a=(0,l.f3)("isVisibleAgregar"),t=(0,l.f3)("isVisibleMasivo"),s=(0,m.Z)(),n=(0,d.iH)(!1),r=(0,d.iH)({}),i=(0,d.iH)(""),u=(0,d.iH)(!1),g=(0,d.iH)({page:1,rowsPerPage:1,rowsNumber:1}),p=async(e=0)=>{try{let e;const o={headers:{"x-token":localStorage.token},params:{pageSize:5}};await c.api.get("/productos",o).then((e=>{const{meta:o,rows:a}=e.data;console.log(o),g.value.page=o.currentPage,g.value.rowsPerPage=o.pageSize,g.value.rowsNumber=o.count})).catch((e=>console.log(e.response)));return e}catch(o){console.log("Error en get",o)}};p();const b=async(e=0,a=5,l,t,s)=>{try{const n={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a}},r={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,filter:l}},i={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,sorter:t,desc:s}};let d;d=""!==l?await c.api.get("/productos",r):t?await c.api.get("/productos",i):await c.api.get("/productos",n);const{currentPage:p,pageSize:m,count:b}=d.data.meta,v=d.data.rows;o.value.splice(0,b,...v),g.value.page=p,g.value.rowsPerPage=m,g.value.rowsNumber=b,g.value.sortBy=t,g.value.descending=s,setInterval((()=>{u.value=!1}),1e3)}catch(n){console.log(n)}};function f(e){u.value=!0;let o=e.filter.toUpperCase();b(e.pagination.page,e.pagination.rowsPerPage,o,e.pagination.sortBy,e.pagination.descending)}const{axiosDelete:h}=v(e.objeto),w="productos/masivo";(0,l.JJ)("url",w);const y={nSerie:{required:!0,label:"nSerie"},ModeloId:{required:!0,label:"ModeloId"},BodegaId:{required:!0,label:"BodegaId"}};(0,l.JJ)("fields",y);const q=!0;return(0,l.JJ)("nserie",q),{axiosDelete:h,productos:o,filter:i,isEditVisible:n,isVisibleAgregar:a,isVisibleMasivo:t,loading:u,objeto:r,onRequest:f,pagination:g,changeToggle:e=>{n.value=e},editarProducto:e=>{n.value=!n.value,r.value=e.row},deleteProducto:e=>{r.value=e.row,s.dialog({title:"Advertencia",message:`Está seguro de querer eliminar ${r.value.Modelo.nombre} \n N°Serie ${r.value.nSerie}`,cancel:!0}).onOk((()=>{h(r.value.id),o.value=o.value.filter((e=>e.id!==r.value.id))}))}}}};var F=a(6429),R=a(4554),$=a(3884),L=a(6778);const X=(0,V.Z)(O,[["render",p]]),Y=X;Q()(O,"components",{QTable:F.Z,QInput:C.Z,QIcon:R.Z,QTd:$.Z,QBtn:M.Z,QDialog:L.Z});const G=[{name:"uid",label:"uid",field:"id",align:"left"},{name:"Modelo",label:"Modelo",field:e=>e.Modelo.nombre,align:"left",sortable:!0},{name:"nSerie",label:"N° Serie",field:"nSerie",align:"left",sortable:!0},{name:"Bodega",label:"Bodega",field:e=>e.Bodega.nombre,align:"left",sortable:!0},{name:"usuario",label:"Creador",field:e=>e.Usuario.nombre,align:"left"},{name:"actions",label:"Actions",field:"",align:"right"}],K={components:{tabla:Y},data(){const e=(0,d.iH)(!1),o=(0,d.iH)(!1);(0,l.JJ)("isVisibleAgregar",e),(0,l.JJ)("isVisibleMasivo",o);const a=(0,d.iH)([]),t=[],s=[],n=async(e=0)=>{try{const e={headers:{"x-token":localStorage.token},params:{pageSize:5}};await c.api.get("/productos",e).then((e=>{const{meta:o,rows:l}=e.data;a.value=l})).catch((e=>console.log(e.response)))}catch(o){console.log("Error en get",o)}};n();const r=async()=>{try{const e={headers:{"x-token":localStorage.token}};await c.api.get("/bodegas/combo",e).then((e=>{const o=e.data;o.forEach((e=>{t.push(e)}))})).catch((e=>console.log(e.response)))}catch(e){console.log("Error en get",e)}};r();const i=async()=>{try{const e={headers:{"x-token":localStorage.token}};await c.api.get("/modelos/combo",e).then((e=>{const o=e.data;o.forEach((e=>{s.push(e)}))})).catch((e=>console.log(e.response)))}catch(e){console.log("Error en get",e)}};i(),(0,l.JJ)("productosArray",a),(0,l.JJ)("modeloArray",s),(0,l.JJ)("bodegaArray",t);const u=()=>{e.value=!e.value},g=()=>{o.value=!o.value};return{cols:G,productosArray:a,isVisibleAgregar:e,toggleAgregar:u,toggleMasivo:g}}};var ee=a(4379);const oe=(0,V.Z)(K,[["render",i]]),ae=oe;Q()(K,"components",{QPage:ee.Z,QBtn:M.Z})}}]);