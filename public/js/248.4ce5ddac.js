"use strict";(self["webpackChunkfront_inventario"]=self["webpackChunkfront_inventario"]||[]).push([[248],{6305:(e,o,a)=>{a.d(o,{Z:()=>_});var l=a(3673),t=a(8880);const s=e=>((0,l.dD)("data-v-56b5c116"),e=e(),(0,l.Cn)(),e),n={id:"app"},i=s((()=>(0,l._)("h5",null,"Carga masiva",-1))),r={class:"row justify-center"};function c(e,o,a,s,c,u){const d=(0,l.up)("q-card-section"),m=(0,l.up)("q-btn"),g=(0,l.up)("vue-csv-toggle-headers"),p=(0,l.up)("vue-csv-errors"),b=(0,l.up)("vue-csv-input"),v=(0,l.up)("vue-csv-map"),f=(0,l.up)("vue-csv-import"),h=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(h,{style:{height:"600px","max-height":"80vh","max-width":"70vw"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[i])),_:1}),(0,l.Wm)(d,{class:"full-width column content-stretch"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:s.csv,"onUpdate:modelValue":o[0]||(o[0]=e=>s.csv=e),fields:s.fields,text:s.texto},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((({hasHeaders:e,toggle:o})=>[(0,l._)("div",r,[(0,l.Wm)(m,{push:"",color:"white","text-color":1==e?"primary":"secondary",label:"Tiene cabecera?",icon:1==e?"las la-times":"las la-check ",onClick:(0,t.iM)(o,["prevent"]),class:"q-my-lg"},null,8,["text-color","icon","onClick"])])])),_:1}),(0,l.Wm)(p),(0,l.Wm)(b),(0,l.Wm)(v),(0,l._)("div",null,[(0,l.Wm)(m,{push:"",color:"white","text-color":"accent",label:"Procesar archivo",onClick:(0,t.iM)(s.procesar,["prevent"]),class:"q-my-lg",disable:s.bloquear},null,8,["onClick","disable"])])])),_:1},8,["modelValue","fields","text"])])),_:1})])),_:1})])}var u=a(1959),d=a(8825),m=a(3739),g=a(5474);const p={components:{VueCsvToggleHeaders:m.H_,VueCsvMap:m.qH,VueCsvInput:m.hX,VueCsvErrors:m.v7,VueCsvImport:m.xD},setup(){const e=(0,d.Z)(),o={headers:{"x-token":localStorage.token}},a=(0,u.iH)(null),t=(0,l.f3)("url"),s=(0,l.f3)("fields"),n=(0,l.f3)("nserie"),i={errors:{fileRequired:"Un archivo es requerido",invalidMimeType:"Tipo de archivo invalido"},toggleHeaders:"Cabecera?   ",submitBtn:"Procesar",fieldColumn:"Campo",csvColumn:"Columna"},r=async()=>{if(n){const o=a.value.reduce(((e,o)=>(e[o.nSerie]=++e[o.nSerie]||0,e)),{}),l=a.value.filter((e=>o[e.nSerie]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nSerie}`})}else{const o=a.value.reduce(((e,o)=>(e[o.nombre]=++e[o.nombre]||0,e)),{});console.log(o);const l=a.value.filter((e=>o[e.nombre]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nombre}`})}await g.api.post(t,a,o).then((o=>{console.log(o),200!=o.status||e.dialog({title:"Exito",message:"Los datos se han cargado con exito "})})).catch((o=>{console.log("Catch ->",o),o&&e.dialog({title:"Error",message:"El archivo tiene datos que no corresponden, por favor revise datos"})}))},c=(0,u.Fl)((()=>null!=a.value?"true":""));return{bloquear:c,csv:a,fields:s,options:o,procesar:r,texto:i}}};var b=a(4260),v=a(151),f=a(5589),h=a(8240),w=a(7518),q=a.n(w);const y=(0,b.Z)(p,[["render",c],["__scopeId","data-v-56b5c116"]]),_=y;q()(p,"components",{QCard:v.Z,QCardSection:f.Z,QBtn:h.Z})},5248:(e,o,a)=>{a.r(o),a.d(o,{default:()=>ee});var l=a(3673),t=a(8880);const s=(0,l._)("div",{class:"row justify-center"},[(0,l._)("h3",null,"Modelos")],-1),n={class:"row xs-12 md-9 justify-center"},i={class:"row justify-center q-mt-md"};function r(e,o,a,r,c,u){const d=(0,l.up)("tabla"),m=(0,l.up)("q-btn"),g=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(g,{class:"q-p2"},{default:(0,l.w5)((()=>[s,(0,l._)("div",n,[(0,l.Wm)(d,{cols:c.cols,tittle:"Listado de modelos"},null,8,["cols"])]),(0,l._)("div",i,[(0,l.Wm)(m,{color:"secondary",icon:"las la-check",label:"Agregar",onClick:(0,t.iM)(c.toggleAgregar,["prevent"])},null,8,["onClick"]),(0,l.Wm)(m,{color:"accent",icon:"las la-paperclip",label:"Carga masiva",onClick:(0,t.iM)(c.toggleMasivo,["prevent"]),class:"q-mx-md"},null,8,["onClick"])])])),_:1})}var c=a(1959),u=a(5474),d=a(2323);const m={class:"full-width row flex-center text-accent q-gutter-sm"};function g(e,o,a,t,s,n){const i=(0,l.up)("q-icon"),r=(0,l.up)("q-input"),c=(0,l.up)("q-btn"),u=(0,l.up)("q-td"),g=(0,l.up)("q-table"),p=(0,l.up)("agregarModelo"),b=(0,l.up)("q-dialog"),v=(0,l.up)("editarModelo"),f=(0,l.up)("masivo");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(g,{columns:a.cols,filter:t.filter,loading:t.loading,"rows-per-page-options":[5,8,10],rows:t.modelos,title:a.tittle,onRequest:t.onRequest,"card-class":"bg-red-1 text-grey-9",class:"q-mt-xl",color:"primary","row-key":"id","rows-per-page-label":"Filas por página",pagination:t.pagination,"onUpdate:pagination":o[1]||(o[1]=e=>t.pagination=e),"binary-state-sort":""},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:t.filter,"onUpdate:modelValue":o[0]||(o[0]=e=>t.filter=e),rounded:"",outlined:"",debounce:"300",placeholder:"buscador","bg-color":"white"},{append:(0,l.w5)((()=>[(0,l.Wm)(i,{name:"las la-search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,l.w5)((e=>[(0,l.Wm)(u,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{dense:"",round:"",flat:"",color:"orange-13",onClick:o=>t.editarModelo(e),icon:"las la-edit"},null,8,["onClick"]),(0,l.Wm)(c,{dense:"",round:"",flat:"",color:"red-14",onClick:o=>t.deleteModelo(e),icon:"las la-trash"},null,8,["onClick"])])),_:2},1032,["props"])])),"no-data":(0,l.w5)((({message:e,filter:o})=>[(0,l._)("div",m,[(0,l.Wm)(i,{size:"2em",name:"las la-meh"}),(0,l._)("span",null," Lamentablemente... "+(0,d.zw)(e),1),(0,l.Wm)(i,{size:"2em",name:o?"las la-frown":"las la-exclamation-triangle"},null,8,["name"])])])),_:1},8,["columns","filter","loading","rows","title","onRequest","pagination"]),(0,l.Wm)(b,{modelValue:t.isVisibleAgregar,"onUpdate:modelValue":o[2]||(o[2]=e=>t.isVisibleAgregar=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isEditVisible,"onUpdate:modelValue":o[3]||(o[3]=e=>t.isEditVisible=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isVisibleMasivo,"onUpdate:modelValue":o[4]||(o[4]=e=>t.isVisibleMasivo=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{onChangeToggle:t.changeToggle},null,8,["onChangeToggle"])])),_:1},8,["modelValue"])],64)}a(71);var p=a(8825);a(8669);const b=e=>{const o=(0,p.Z)(),a={headers:{"x-token":localStorage.token}},l=async()=>{try{console.log("object");let l={nombre:e.nombre,categoria:e.Categorium.id,stock_minimo:e.stock_minimo};await u.api.put(`modelos/${e.id}`,l,a).then((e=>{console.log(e.status),200===e.status&&o.dialog({title:"Exito al actualizar",message:e.data.msg,cancel:!0})})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&o.dialog({title:"Alerta de repetidos",message:e.response.data.msg})}))}catch(l){console.log(l)}},t=async(e="")=>{try{await u.api["delete"](`modelos/${e}`,a).then((e=>{console.log(e),200===e.status&&o.dialog({title:"Exito",message:e.data.msg})})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg})}))}catch(l){console.log(l)}},s=async()=>{let l;try{await u.api.post("modelos",e.value,a).then((e=>{201===e.status&&(o.dialog({title:"Exito al agregar",message:`${e.data.nombre} se ha agregado con exito`}),l=e.data)})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&o.dialog({title:"Alerta",message:e.response.data.msg})}));return l}catch(t){console.log(t)}};return{axiosPut:l,axiosDelete:t,axiosPost:s}},v=b;var f=a(6305);const h={class:"row justify-center"},w=(0,l._)("div",{class:"text-h5 text-primary"},"Agregar modelo",-1),q=(0,l.Uk)(" No results ");function y(e,o,a,s,n,i){const r=(0,l.up)("q-card-section"),c=(0,l.up)("q-input"),u=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),m=(0,l.up)("q-select"),g=(0,l.up)("q-btn"),p=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",h,[(0,l.Wm)(b,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{onSubmit:(0,t.iM)(s.agregarModelo,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:s.modelo.nombre,"onUpdate:modelValue":o[0]||(o[0]=e=>s.modelo.nombre=e),filled:"",label:"Nombre de modelo"},null,8,["modelValue"]),(0,l.Wm)(m,{filled:"",modelValue:s.modelo.categoria,"onUpdate:modelValue":o[1]||(o[1]=e=>s.modelo.categoria=e),options:s.categorias,label:"Categoria",style:{width:"250px"},hint:"Seleccione una categoria","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"text-grey"},{default:(0,l.w5)((()=>[q])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l.Wm)(c,{filled:"",type:"number",min:"0",max:"50",modelValue:s.modelo.stock_minimo,"onUpdate:modelValue":o[2]||(o[2]=e=>s.modelo.stock_minimo=e),modelModifiers:{number:!0},label:"Stock minimo"},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(g,{disable:s.bloqued,label:"Agregar",class:"full-width",type:"submit",color:s.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const _={setup(){const e=(0,l.f3)("modelosArray"),o=(0,l.f3)("comboArray"),a=(0,c.iH)([]),t=()=>{o.forEach((e=>{let o={label:e.nombre,value:e.id};a.value.push(o)}))};t();const s=(0,c.iH)({nombre:"",categoria:"",stock_minimo:0}),{axiosPost:n}=v(s),i=()=>{let o=n().then((o=>{o&&e.value.push(o)}));const a=e=>{};a(o),s.value={nombre:"",categoria:"",stock_minimo:0}},r=(0,c.Fl)((()=>(!s.value.nombre||!s.value.categoria)&&"disable")),u=(0,c.Fl)((()=>"disable"===r.value?"negative":"secondary"));return{agregarModelo:i,bloqued:r,categorias:a,colorButton:u,comboArray:o,modelo:s}}};var k=a(4260),V=a(151),x=a(5589),C=a(5269),W=a(4842),S=a(8516),Z=a(3414),A=a(2035),M=a(8240),j=a(7518),Q=a.n(j);const P=(0,k.Z)(_,[["render",y]]),H=P;Q()(_,"components",{QCard:V.Z,QCardSection:x.Z,QForm:C.Z,QInput:W.Z,QSelect:S.Z,QItem:Z.Z,QItemSection:A.Z,QBtn:M.Z});const T={class:"row justify-center"},E=(0,l._)("h5",null,"Modificar modelo",-1),U=(0,l.Uk)(" No results ");function I(e,o,a,s,n,i){const r=(0,l.up)("q-section"),c=(0,l.up)("q-input"),u=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),m=(0,l.up)("q-select"),g=(0,l.up)("q-btn"),p=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",T,[(0,l.Wm)(b,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{class:"text-center q-pb-sm"},{default:(0,l.w5)((()=>[E])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{onSubmit:(0,t.iM)(s.axiosPut,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:s.pObjeto.nombre,"onUpdate:modelValue":o[0]||(o[0]=e=>s.pObjeto.nombre=e),filled:"",label:"Nombre de modelo"},null,8,["modelValue"]),(0,l.Wm)(m,{filled:"",modelValue:s.pObjeto.Categorium.id,"onUpdate:modelValue":o[1]||(o[1]=e=>s.pObjeto.Categorium.id=e),options:s.categorias,label:"Categoria",style:{width:"250px"},hint:"Seleccione una categoria","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"text-grey"},{default:(0,l.w5)((()=>[U])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l.Wm)(c,{filled:"",type:"number",min:"0",max:"50",modelValue:s.pObjeto.stock_minimo,"onUpdate:modelValue":o[2]||(o[2]=e=>s.pObjeto.stock_minimo=e),modelModifiers:{number:!0},label:"Stock minimo"},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(g,{label:"Actualizar",class:"full-width",type:"submit",color:s.colorButton},null,8,["color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const z={props:{objeto:{type:Object,required:!0}},setup(e){const{axiosPut:o}=v(e.objeto),a=(0,l.f3)("comboArray"),t=(0,c.iH)([]),s=()=>{a.forEach((e=>{let o={label:e.nombre,value:e.id};t.value.push(o)}))};s();const n=(0,c.Fl)((()=>!e.objeto.nombre&&"disable")),i=(0,c.Fl)((()=>"disable"===n.value?"negative":"warning"));return{axiosPut:o,bloqued:n,categorias:t,colorButton:i,pObjeto:e.objeto}}},B=(0,k.Z)(z,[["render",I]]),J=B;Q()(z,"components",{QCard:V.Z,QForm:C.Z,QInput:W.Z,QSelect:S.Z,QItem:Z.Z,QItemSection:A.Z,QBtn:M.Z});const D={components:{agregarModelo:H,editarModelo:J,masivo:f.Z},props:{tittle:String,cols:Array},setup(e){const o=(0,l.f3)("modelosArray"),a=(0,l.f3)("isVisibleAgregar"),t=(0,l.f3)("isVisibleMasivo"),s=(0,p.Z)(),n=(0,c.iH)(!1),i=(0,c.iH)({}),r=(0,c.iH)(""),d=(0,c.iH)(!1),m=(0,c.iH)({page:1,rowsPerPage:1,rowsNumber:1}),g=async(e=0)=>{try{let e;const o={headers:{"x-token":localStorage.token},params:{pageSize:5}};await u.api.get("/modelos",o).then((e=>{const{meta:o,rows:a}=e.data;console.log(o),m.value.page=o.currentPage,m.value.rowsPerPage=o.pageSize,m.value.rowsNumber=o.count})).catch((e=>console.log(e.response)));return e}catch(o){console.log("Error en get",o)}};g();const b=async(e=0,a=5,l,t,s)=>{try{const n={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a}},i={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,filter:l}},r={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,sorter:t,desc:s}};let c;c=""!==l?await u.api.get("/modelos",i):t?await u.api.get("/modelos",r):await u.api.get("/modelos",n);const{currentPage:g,pageSize:p,count:b}=c.data.meta,v=c.data.rows;o.value.splice(0,b,...v),m.value.page=g,m.value.rowsPerPage=p,m.value.rowsNumber=b,m.value.sortBy=t,m.value.descending=s,setInterval((()=>{d.value=!1}),1e3)}catch(n){console.log(n)}};function f(e){d.value=!0;let o=e.filter.toUpperCase();b(e.pagination.page,e.pagination.rowsPerPage,o,e.pagination.sortBy,e.pagination.descending)}const{axiosDelete:h}=v(e.objeto),w="modelos/masivo";(0,l.JJ)("url",w);const q={nombre:{required:!0,label:"Nombre"},stock_minimo:{required:!0,label:"Stock minimo"},categoria:{required:!0,label:"Id Categoria"}};return(0,l.JJ)("fields",q),{axiosDelete:h,modelos:o,filter:r,isEditVisible:n,isVisibleAgregar:a,isVisibleMasivo:t,loading:d,objeto:i,onRequest:f,pagination:m,changeToggle:e=>{n.value=e},editarModelo:e=>{n.value=!n.value,i.value=e.row},deleteModelo:e=>{i.value=e.row,s.dialog({title:"Advertencia",message:`Está seguro de querer eliminar ${i.value.nombre}`,cancel:!0}).onOk((()=>{h(i.value.id),o.value=o.value.filter((e=>e.id!==i.value.id))}))}}}};var N=a(6429),O=a(4554),F=a(3884),R=a(6778);const $=(0,k.Z)(D,[["render",g]]),L=$;Q()(D,"components",{QTable:N.Z,QInput:W.Z,QIcon:O.Z,QTd:F.Z,QBtn:M.Z,QDialog:R.Z});const X=[{name:"uid",label:"uid",field:"id",align:"right"},{name:"nombre",label:"Nombre modelo",field:"nombre",align:"left",sortable:!0},{name:"CategoriumId",label:"Categoria",field:e=>e.Categorium.nombre,align:"left",sortable:!0},{name:"stock_minimo",label:"Stock mínimo",field:"stock_minimo",align:"right",sortable:!0},{name:"actions",label:"Actions",field:"",align:"right"}],Y={components:{tabla:L},data(){const e=(0,c.iH)(!1),o=(0,c.iH)(!1);(0,l.JJ)("isVisibleAgregar",e),(0,l.JJ)("isVisibleMasivo",o);const a=(0,c.iH)([]),t=[],s=async(e=0)=>{try{const e={headers:{"x-token":localStorage.token},params:{pageSize:5}};await u.api.get("/modelos",e).then((e=>{const{meta:o,rows:l}=e.data;a.value=l})).catch((e=>console.log(e.response)))}catch(o){console.log("Error en get",o)}};s();const n=async()=>{try{const e={headers:{"x-token":localStorage.token}};await u.api.get("/categorias/combo",e).then((e=>{const o=e.data;o.forEach((e=>{t.push(e)}))})).catch((e=>console.log(e.response)))}catch(e){console.log("Error en get",e)}};n(),(0,l.JJ)("modelosArray",a),(0,l.JJ)("comboArray",t);const i=()=>{e.value=!e.value},r=()=>{o.value=!o.value};return{cols:X,modelosArray:a,isVisibleAgregar:e,toggleAgregar:i,toggleMasivo:r,comboArray:t}}};var G=a(4379);const K=(0,k.Z)(Y,[["render",r]]),ee=K;Q()(Y,"components",{QPage:G.Z,QBtn:M.Z})}}]);