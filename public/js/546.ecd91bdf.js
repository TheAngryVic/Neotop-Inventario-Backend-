"use strict";(self["webpackChunkfront_inventario"]=self["webpackChunkfront_inventario"]||[]).push([[546],{546:(e,o,a)=>{a.r(o),a.d(o,{default:()=>se});var l=a(3673),t=a(8880);const n=(0,l._)("div",{class:"row justify-center"},[(0,l._)("h3",null,"Servicio técnico")],-1),i={class:"row xs-12 md-9 justify-center"},c={class:"row justify-center q-mt-md"};function s(e,o,a,s,r,d){const u=(0,l.up)("tabla"),g=(0,l.up)("q-btn"),p=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(p,{class:"q-p2"},{default:(0,l.w5)((()=>[n,(0,l._)("div",i,[(0,l.Wm)(u,{cols:r.cols,tittle:"Listado de productos"},null,8,["cols"])]),(0,l._)("div",c,[(0,l.Wm)(g,{color:"secondary",icon:"las la-check",label:"Agregar",onClick:(0,t.iM)(r.toggleAgregar,["prevent"])},null,8,["onClick"])])])),_:1})}var r=a(1959),d=a(5474),u=a(2323);const g=e=>((0,l.dD)("data-v-a8652780"),e=e(),(0,l.Cn)(),e),p=g((()=>(0,l._)("div",{class:"text-h6"},"Diagnostico entrada",-1))),m=g((()=>(0,l._)("div",{class:"text-h6"},"Diagnostico salida",-1))),b={class:"full-width row flex-center text-accent q-gutter-sm"};function f(e,o,a,t,n,i){const c=(0,l.up)("q-icon"),s=(0,l.up)("q-input"),r=(0,l.up)("q-td"),d=(0,l.up)("q-btn"),g=(0,l.up)("q-card-section"),f=(0,l.up)("q-card-actions"),w=(0,l.up)("q-card"),h=(0,l.up)("q-dialog"),v=(0,l.up)("q-table"),_=(0,l.up)("agregar"),y=(0,l.up)("actualizar"),q=(0,l.up)("cerrar"),V=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,{columns:a.cols,filter:t.filter,loading:t.loading,"rows-per-page-options":[5,8,10],rows:t.stecnico,title:a.tittle,onRequest:t.onRequest,"card-class":"bg-red-1 text-grey-9",class:"q-mt-xl",color:"primary","row-key":"id","rows-per-page-label":"Filas por página",pagination:t.pagination,"onUpdate:pagination":o[1]||(o[1]=e=>t.pagination=e),"binary-state-sort":""},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:t.filter,"onUpdate:modelValue":o[0]||(o[0]=e=>t.filter=e),rounded:"",outlined:"",debounce:"300",placeholder:"buscador","bg-color":"white"},{append:(0,l.w5)((()=>[(0,l.Wm)(c,{name:"las la-search"})])),_:1},8,["modelValue"])])),"body-cell-fecha_entrada":(0,l.w5)((e=>[(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.row.fecha_entrada),1)])),_:2},1024)])),"body-cell-diagnostico_entrada":(0,l.w5)((e=>[(0,l.Wm)(r,{"auto-width":""},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{size:"sm",color:"accent",round:"",dense:"",onClick:o=>(e.expand=!e.expand,t.cerrado=!1),icon:e.expand?"las la-minus":"las la-plus"},null,8,["onClick","icon"])])),_:2},1024),t.cerrado?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(h,{key:0,modelValue:e.expand,"onUpdate:modelValue":o=>e.expand=o},{default:(0,l.w5)((()=>[(0,l.Wm)(w,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[p])),_:1}),(0,l.Wm)(g,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.row.diagnostico_entrada),1)])),_:2},1024),(0,l.Wm)(f,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(d,{flat:"",label:"OK",color:"primary"},null,512),[[V]])])),_:1})])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]))])),"body-cell-diagnostico_salida":(0,l.w5)((e=>[(0,l.Wm)(r,{"auto-width":""},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{size:"sm",color:"accent",round:"",dense:"",onClick:o=>(e.expand=!e.expand,t.cerrado=!0),icon:e.expand?"las la-minus":"las la-plus"},null,8,["onClick","icon"])])),_:2},1024),t.cerrado?((0,l.wg)(),(0,l.j4)(h,{key:0,modelValue:e.expand,"onUpdate:modelValue":o=>e.expand=o},{default:(0,l.w5)((()=>[(0,l.Wm)(w,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[m])),_:1}),(0,l.Wm)(g,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(e.row.diagnostico_salida),1)])),_:2},1024),(0,l.Wm)(f,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(d,{flat:"",label:"OK",color:"primary"},null,512),[[V]])])),_:1})])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])):(0,l.kq)("",!0)])),"body-cell-actions":(0,l.w5)((e=>[(0,l.Wm)(r,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{dense:"",round:"",flat:"",color:"orange-13",onClick:o=>t.editarTecnico(e),icon:"las la-edit"},null,8,["onClick"]),(0,l.Wm)(d,{dense:"",round:"",flat:"",color:e.row.estado?"red-14":"green-14",onClick:o=>t.closeTecnico(e),icon:e.row.estado?"las la-trash":"las la-plus-circle"},null,8,["color","onClick","icon"])])),_:2},1032,["props"])])),"no-data":(0,l.w5)((({message:e,filter:o})=>[(0,l._)("div",b,[(0,l.Wm)(c,{size:"2em",name:"las la-meh"}),(0,l._)("span",null," Lamentablemente... "+(0,u.zw)(e),1),(0,l.Wm)(c,{size:"2em",name:o?"las la-frown":"las la-exclamation-triangle"},null,8,["name"])])])),_:1},8,["columns","filter","loading","rows","title","onRequest","pagination"]),(0,l.Wm)(h,{modelValue:t.isVisibleAgregar,"onUpdate:modelValue":o[2]||(o[2]=e=>t.isVisibleAgregar=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{objeto:t.objeto},null,8,["objeto"])])),_:1},8,["modelValue"]),(0,l.Wm)(h,{modelValue:t.isEditVisible,"onUpdate:modelValue":o[3]||(o[3]=e=>t.isEditVisible=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(h,{modelValue:t.isCloseVisible,"onUpdate:modelValue":o[4]||(o[4]=e=>t.isCloseVisible=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"])],64)}a(71);const w={class:"row justify-center"},h=(0,l._)("div",{class:"text-h5 text-primary"},"Agregar a Servicio técnico",-1),v=(0,l.Uk)(" No results ");function _(e,o,a,n,i,c){const s=(0,l.up)("q-card-section"),r=(0,l.up)("q-input"),d=(0,l.up)("q-item-section"),u=(0,l.up)("q-item"),g=(0,l.up)("q-select"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",w,[(0,l.Wm)(b,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,null,{default:(0,l.w5)((()=>[h])),_:1}),(0,l.Wm)(s,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{onSubmit:(0,t.iM)(n.agregarTecnico,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{filled:"",label:"Cliente",modelValue:n.tecnico.cliente,"onUpdate:modelValue":o[0]||(o[0]=e=>n.tecnico.cliente=e)},null,8,["modelValue"]),(0,l.Wm)(g,{filled:"",modelValue:n.tecnico.ProductoId,"onUpdate:modelValue":o[1]||(o[1]=e=>n.tecnico.ProductoId=e),options:n.select,label:"Equipo",style:{width:"250px"},hint:"Seleccione un equipo","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"text-grey"},{default:(0,l.w5)((()=>[v])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l.Wm)(r,{filled:"",label:"Diagnostico",modelValue:n.tecnico.diagnostico_entrada,"onUpdate:modelValue":o[2]||(o[2]=e=>n.tecnico.diagnostico_entrada=e),type:"textarea",maxlength:"500",autogrow:""},null,8,["modelValue"]),(0,l.Wm)(r,{filled:"",label:"Técnico",modelValue:n.tecnico.tecnico,"onUpdate:modelValue":o[3]||(o[3]=e=>n.tecnico.tecnico=e)},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(p,{disable:n.bloqued,label:"Agregar",class:"full-width",type:"submit",color:n.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}var y=a(8825);a(8669);const q=e=>{const o=(0,y.Z)(),a={headers:{"x-token":localStorage.token}},l=async()=>{let l;try{console.log(e),await d.api.put(`stecnico/completar/${e.id}`,e,a).then((e=>{console.log(e),200===e.status&&o.dialog({title:"Exito",message:"Actualizado con exito"}),l=e}))}catch(t){console.log(t)}return l},t=async()=>{let l;try{await d.api.put(`stecnico/${e.id}`,e,a).then((e=>{console.log(e),200===e.status&&o.dialog({title:"Exito",message:"Actualizado con exito"}),l=e}))}catch(t){console.log(t)}return l},n=async(e="")=>{try{await d.api["delete"](`usuarios/${e}`,a).then((e=>{console.log(e),200===e.status&&o.dialog({title:"Exito",message:"Eliminado con exito"})})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg})}))}catch(l){console.log(l)}},i=async()=>{let l;try{await d.api.post("stecnico",e.value,a).then((e=>{console.log(e),201===e.status&&(o.dialog({title:"Exito al agregar",message:e.data.msg}),l=e.data.raw)})).catch((e=>{401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.errors[0].msg}),400===e.response.status&&o.dialog({title:"Alerta",message:e.response.data.errors[0].msg})}));return l}catch(t){console.log(t)}};return{axiosPut:t,axiosDelete:n,axiosPost:i,axiosClose:l}},V=q,W={setup(){const e=(0,l.f3)("tecnicoArray"),o=(0,l.f3)("comboArray"),a=(0,r.iH)([]),t=()=>{o.forEach((e=>{let o={label:`${e.nSerie} - ${e.Modelo.nombre}`,value:e.id};a.value.push(o)}))};t();const n=(0,r.iH)({cliente:"",diagnostico_entrada:"",tecnico:"",ProductoId:""}),{axiosPost:i}=V(n),c=()=>{i().then((o=>{console.log(o),e.value.push(o)}));n.value={cliente:"",diagnostico_entrada:"",tecnico:"",ProductoId:""}},s=(0,r.Fl)((()=>!(n.value.cliente&&n.value.diagnostico_entrada&&n.value.tecnico&&n.value.ProductoId)&&"disable")),d=(0,r.Fl)((()=>"disable"===s.value?"negative":"secondary"));return{tecnico:n,agregarTecnico:c,select:a,colorButton:d,bloqued:s}}};var x=a(4260),j=a(151),k=a(5589),S=a(5269),C=a(4842),Z=a(8516),P=a(3414),Q=a(2035),A=a(8240),U=a(7518),z=a.n(U);const T=(0,x.Z)(W,[["render",_]]),E=T;z()(W,"components",{QCard:j.Z,QCardSection:k.Z,QForm:S.Z,QInput:C.Z,QSelect:Z.Z,QItem:P.Z,QItemSection:Q.Z,QBtn:A.Z});const I={class:"row justify-center"},H=(0,l.Uk)(" No results ");function B(e,o,a,n,i,c){const s=(0,l.up)("q-input"),r=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),u=(0,l.up)("q-select"),g=(0,l.up)("q-btn"),p=(0,l.up)("q-form"),m=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",I,[(0,l.Wm)(m,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{onSubmit:(0,t.iM)(n.axiosPut,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{filled:"",label:"Cliente",modelValue:n.pObjeto.cliente,"onUpdate:modelValue":o[0]||(o[0]=e=>n.pObjeto.cliente=e)},null,8,["modelValue"]),(0,l.Wm)(u,{filled:"",modelValue:n.pObjeto.Producto.nSerie,"onUpdate:modelValue":o[1]||(o[1]=e=>n.pObjeto.Producto.nSerie=e),options:n.select,label:"Equipo",style:{width:"250px"},hint:"Seleccione un equipo","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r,{class:"text-grey"},{default:(0,l.w5)((()=>[H])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l.Wm)(s,{filled:"",label:"Diagnostico",modelValue:n.pObjeto.diagnostico_entrada,"onUpdate:modelValue":o[2]||(o[2]=e=>n.pObjeto.diagnostico_entrada=e),type:"textarea",autogrow:""},null,8,["modelValue"]),(0,l.Wm)(s,{filled:"",label:"Técnico",modelValue:n.pObjeto.tecnico,"onUpdate:modelValue":o[3]||(o[3]=e=>n.pObjeto.tecnico=e)},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(g,{disable:n.bloqued,label:"Actualizar",class:"full-width",type:"submit",color:n.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])}const D={props:{objeto:{type:Object,required:!0}},setup(e){const{axiosPut:o}=V(e.objeto),a=(0,l.f3)("comboArray"),t=(0,r.iH)([]),n=()=>{a.forEach((e=>{let o={label:`${e.nSerie} - ${e.Modelo.nombre}`,value:e.id};t.value.push(o)}))};n();const i=(0,r.Fl)((()=>!(e.objeto.cliente&&e.objeto.diagnostico_entrada&&e.objeto.tecnico)&&"disable")),c=(0,r.Fl)((()=>"disable"===i.value?"negative":"warning"));return{axiosPut:o,bloqued:i,select:t,colorButton:c,pObjeto:e.objeto}}},O=(0,x.Z)(D,[["render",B]]),F=O;z()(D,"components",{QCard:j.Z,QForm:S.Z,QInput:C.Z,QSelect:Z.Z,QItem:P.Z,QItemSection:Q.Z,QBtn:A.Z});const M={class:"row justify-center"};function $(e,o,a,n,i,c){const s=(0,l.up)("q-input"),r=(0,l.up)("q-btn"),d=(0,l.up)("q-form"),u=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",M,[(0,l.Wm)(u,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{onSubmit:(0,t.iM)(n.procesarClose,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{filled:"",label:"Diagnostico",modelValue:n.data.diagnostico_salida,"onUpdate:modelValue":o[0]||(o[0]=e=>n.data.diagnostico_salida=e),type:"textarea",autogrow:"",maxlength:"500"},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(r,{disable:n.bloqued,label:"Finalizar",class:"full-width",type:"submit",color:n.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])}const J={props:{objeto:{type:Object,required:!0}},setup(e){const o=(0,l.f3)("tecnicoArray");(0,r.Vh)(e);const a=(0,r.iH)({id:e.objeto.id,diagnostico_salida:""}),{axiosClose:t}=V(a.value),n=async()=>{t().then((e=>{console.log(o.value),o.value=o.value.filter((o=>o.id!==e.data.tecnico.id)),o.value.push(e.data.tecnico),console.log("Im here",e.data.tecnico)})),console.log(a)},i=((0,r.iH)([]),(0,r.Fl)((()=>!a.value.diagnostico_salida&&"disable"))),c=(0,r.Fl)((()=>"disable"===i.value?"negative":"warning"));return{axiosClose:t,data:a,bloqued:i,colorButton:c,pObjeto:e.objeto,procesarClose:n}}},N=(0,x.Z)(J,[["render",$]]),R=N;z()(J,"components",{QCard:j.Z,QForm:S.Z,QInput:C.Z,QBtn:A.Z});const K={props:{tittle:String,cols:Array},components:{agregar:E,actualizar:F,cerrar:R},setup(e){const o=(0,l.f3)("tecnicoArray"),a=(0,l.f3)("isVisibleAgregar"),t=(0,r.iH)(!1),n=(0,r.iH)(!1),i=(0,r.iH)({}),c=(0,r.iH)(""),s=(0,r.iH)(!1),u=(0,r.iH)({page:1,sortBy:"fecha_entrada",rowsPerPage:1,rowsNumber:1}),g=async(e=0)=>{try{let e;const o={headers:{"x-token":localStorage.token},params:{pageSize:5}};await d.api.get("/stecnico",o).then((e=>{const{meta:o,rows:a}=e.data;console.log(o),u.value.page=o.currentPage,u.value.rowsPerPage=o.pageSize,u.value.rowsNumber=o.count})).catch((e=>console.log(e.response)));return e}catch(o){console.log("Error en get",o)}};g();const p=async(e=0,a=5,l,t,n)=>{try{const i={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a}},c={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,filter:l}},r={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,sorter:t,desc:n}};let g;g=""!==l?await d.api.get("/stecnico",c):t?await d.api.get("/stecnico",r):await d.api.get("/stecnico",i);const{currentPage:p,pageSize:m,count:b}=g.data.meta,f=g.data.rows;o.value.splice(0,b,...f),u.value.page=p,u.value.rowsPerPage=m,u.value.rowsNumber=b,u.value.sortBy=t,u.value.descending=n,setInterval((()=>{s.value=!1}),1e3)}catch(i){console.log(i)}};function m(e){s.value=!0;let o=e.filter.toUpperCase();p(e.pagination.page,e.pagination.rowsPerPage,o,e.pagination.sortBy,e.pagination.descending)}return{cerrado:(0,r.iH)(!1),stecnico:o,filter:c,loading:s,isVisibleAgregar:a,isEditVisible:t,isCloseVisible:n,objeto:i,onRequest:m,pagination:u,changeToggle:e=>{t.value=e,n.value=e},editarTecnico:e=>{t.value=!t.value,console.log(e.row),i.value=e.row},closeTecnico:e=>{n.value=!n.value,console.log(e.row),i.value=e.row}}}};var L=a(6429),Y=a(4554),G=a(3884),X=a(6778),ee=a(9367),oe=a(677);const ae=(0,x.Z)(K,[["render",f],["__scopeId","data-v-a8652780"]]),le=ae;z()(K,"components",{QTable:L.Z,QInput:C.Z,QIcon:Y.Z,QTd:G.Z,QBtn:A.Z,QDialog:X.Z,QCard:j.Z,QCardSection:k.Z,QCardActions:ee.Z}),z()(K,"directives",{ClosePopup:oe.Z});const te=[{name:"cliente",label:"Cliente",field:"cliente",align:"left",sortable:!0},{name:"nSerie",label:"N° Serie",field:e=>e.Producto.nSerie,align:"left",sortable:!0},{name:"Producto.Modelo.nombre",label:"Equipo",field:e=>e.Producto.Modelo.nombre,align:"left",sortable:!0},{name:"fecha_entrada",label:"Fecha entrada",field:"fecha_entrada",align:"left"},{name:"diagnostico_entrada",label:"Diagnostico de entrada",field:"diagnostico_entrada",align:"left"},{name:"tecnico",label:"Técnico",field:"tecnico",align:"left",sortable:!0},{name:"diagnostico_salida",label:"Diagnostico salida",field:"diagnostico_salida",align:"left"},{name:"fecha_salida",label:"Fecha Salida",field:"fecha_salida",align:"left"},{name:"actions",label:"Actions",field:"",align:"right"}],ne={components:{tabla:le},data(){const e=(0,r.iH)(!1);(0,l.JJ)("isVisibleAgregar",e);let o=[];const a=(0,r.iH)([]),t=async(e=1)=>{try{const o={headers:{"x-token":localStorage.token},params:{pageSize:5,currentPage:e}};await d.api.get("/stecnico",o).then((e=>{const{meta:o,rows:l}=e.data;a.value=l})).catch((e=>console.log(e.response)))}catch(o){console.log("Error en get",o)}};t(),(0,l.JJ)("tecnicoArray",a);const n=()=>{e.value=!e.value},i=async()=>{try{const e={headers:{"x-token":localStorage.token}};await d.api.get("/productos/select",e).then((e=>{const a=e.data;a.forEach((e=>{o.push(e)}))})).catch((e=>console.log(e.response)))}catch(e){console.log("Error en get",e)}};return i(),(0,l.JJ)("comboArray",o),{cols:te,tecnicoArray:a,isVisibleAgregar:e,toggleAgregar:n}}};var ie=a(4379);const ce=(0,x.Z)(ne,[["render",s]]),se=ce;z()(ne,"components",{QPage:ie.Z,QBtn:A.Z})}}]);