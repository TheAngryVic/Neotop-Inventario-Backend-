"use strict";(self["webpackChunkfront_inventario"]=self["webpackChunkfront_inventario"]||[]).push([[888],{6305:(e,a,o)=>{o.d(a,{Z:()=>V});var t=o(3673),l=o(8880);const s=e=>((0,t.dD)("data-v-56b5c116"),e=e(),(0,t.Cn)(),e),n={id:"app"},r=s((()=>(0,t._)("h5",null,"Carga masiva",-1))),i={class:"row justify-center"};function c(e,a,o,s,c,u){const d=(0,t.up)("q-card-section"),g=(0,t.up)("q-btn"),m=(0,t.up)("vue-csv-toggle-headers"),p=(0,t.up)("vue-csv-errors"),v=(0,t.up)("vue-csv-input"),b=(0,t.up)("vue-csv-map"),f=(0,t.up)("vue-csv-import"),h=(0,t.up)("q-card");return(0,t.wg)(),(0,t.iD)("div",n,[(0,t.Wm)(h,{style:{height:"600px","max-height":"80vh","max-width":"70vw"}},{default:(0,t.w5)((()=>[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[r])),_:1}),(0,t.Wm)(d,{class:"full-width column content-stretch"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:s.csv,"onUpdate:modelValue":a[0]||(a[0]=e=>s.csv=e),fields:s.fields,text:s.texto},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((({hasHeaders:e,toggle:a})=>[(0,t._)("div",i,[(0,t.Wm)(g,{push:"",color:"white","text-color":1==e?"primary":"secondary",label:"Tiene cabecera?",icon:1==e?"las la-times":"las la-check ",onClick:(0,l.iM)(a,["prevent"]),class:"q-my-lg"},null,8,["text-color","icon","onClick"])])])),_:1}),(0,t.Wm)(p),(0,t.Wm)(v),(0,t.Wm)(b),(0,t._)("div",null,[(0,t.Wm)(g,{push:"",color:"white","text-color":"accent",label:"Procesar archivo",onClick:(0,l.iM)(s.procesar,["prevent"]),class:"q-my-lg",disable:s.bloquear},null,8,["onClick","disable"])])])),_:1},8,["modelValue","fields","text"])])),_:1})])),_:1})])}var u=o(1959),d=o(8825),g=o(3739),m=o(5474);const p={components:{VueCsvToggleHeaders:g.H_,VueCsvMap:g.qH,VueCsvInput:g.hX,VueCsvErrors:g.v7,VueCsvImport:g.xD},setup(){const e=(0,d.Z)(),a={headers:{"x-token":localStorage.token}},o=(0,u.iH)(null),l=(0,t.f3)("url"),s=(0,t.f3)("fields"),n=(0,t.f3)("nserie"),r={errors:{fileRequired:"Un archivo es requerido",invalidMimeType:"Tipo de archivo invalido"},toggleHeaders:"Cabecera?   ",submitBtn:"Procesar",fieldColumn:"Campo",csvColumn:"Columna"},i=async()=>{if(n){const a=o.value.reduce(((e,a)=>(e[a.nSerie]=++e[a.nSerie]||0,e)),{}),t=o.value.filter((e=>a[e.nSerie]));if(console.log("Repetidos",t),t.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${t[0].nSerie}`})}else{const a=o.value.reduce(((e,a)=>(e[a.nombre]=++e[a.nombre]||0,e)),{});console.log(a);const t=o.value.filter((e=>a[e.nombre]));if(console.log("Repetidos",t),t.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${t[0].nombre}`})}await m.api.post(l,o,a).then((a=>{console.log(a),200!=a.status||e.dialog({title:"Exito",message:"Los datos se han cargado con exito "})})).catch((a=>{console.log("Catch ->",a),a&&e.dialog({title:"Error",message:"El archivo tiene datos que no corresponden, por favor revise datos"})}))},c=(0,u.Fl)((()=>null!=o.value?"true":""));return{bloquear:c,csv:o,fields:s,options:a,procesar:i,texto:r}}};var v=o(4260),b=o(151),f=o(5589),h=o(8240),w=o(7518),C=o.n(w);const q=(0,v.Z)(p,[["render",c],["__scopeId","data-v-56b5c116"]]),V=q;C()(p,"components",{QCard:b.Z,QCardSection:f.Z,QBtn:h.Z})},3888:(e,a,o)=>{o.r(a),o.d(a,{default:()=>$});var t=o(3673),l=o(8880);const s=(0,t._)("div",{class:"row justify-center"},[(0,t._)("h3",null,"Categorias")],-1),n={class:"row xs-12 md-9 justify-center"},r={class:"row justify-center q-mt-md"};function i(e,a,o,i,c,u){const d=(0,t.up)("tablaInventario"),g=(0,t.up)("q-btn"),m=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(m,{class:"q-p2"},{default:(0,t.w5)((()=>[s,(0,t._)("div",n,[(0,t.Wm)(d,{cols:c.cols,tittle:"Categorias"},null,8,["cols"])]),(0,t._)("div",r,[(0,t.Wm)(g,{color:"secondary",icon:"las la-check",label:"Agregar",onClick:(0,l.iM)(c.toggleAgregar,["prevent"])},null,8,["onClick"]),(0,t.Wm)(g,{color:"accent",icon:"las la-paperclip",label:"Carga masiva",onClick:(0,l.iM)(c.toggleMasivo,["prevent"]),class:"q-mx-md"},null,8,["onClick"])])])),_:1})}var c=o(1959),u=o(5474),d=o(2323);const g={class:"full-width row flex-center text-accent q-gutter-sm"};function m(e,a,o,l,s,n){const r=(0,t.up)("q-icon"),i=(0,t.up)("q-input"),c=(0,t.up)("q-btn"),u=(0,t.up)("q-td"),m=(0,t.up)("q-table"),p=(0,t.up)("dialogForm"),v=(0,t.up)("q-dialog"),b=(0,t.up)("dialogFormCategoriaPOST"),f=(0,t.up)("masivo");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(m,{columns:o.cols,filter:l.filter,loading:l.loading,"rows-per-page-options":[5,8,10],rows:l.categorias,title:o.tittle,onRequest:l.onRequest,"card-class":"bg-red-1 text-grey-9",class:"q-mt-xl",color:"primary","row-key":"id","rows-per-page-label":"Filas por página",pagination:l.pagination,"onUpdate:pagination":a[1]||(a[1]=e=>l.pagination=e),"binary-state-sort":""},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:l.filter,"onUpdate:modelValue":a[0]||(a[0]=e=>l.filter=e),rounded:"",outlined:"",debounce:"300",placeholder:"buscador","bg-color":"white"},{append:(0,t.w5)((()=>[(0,t.Wm)(r,{name:"las la-search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,t.w5)((e=>[(0,t.Wm)(u,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{dense:"",round:"",flat:"",color:"orange-13",onClick:a=>l.editCategoria(e),icon:"las la-edit"},null,8,["onClick"]),(0,t.Wm)(c,{dense:"",round:"",flat:"",color:"red-14",onClick:a=>l.deleteCategoria(e),icon:"las la-trash"},null,8,["onClick"])])),_:2},1032,["props"])])),"no-data":(0,t.w5)((({message:e,filter:a})=>[(0,t._)("div",g,[(0,t.Wm)(r,{size:"2em",name:"las la-meh"}),(0,t._)("span",null," Lamentablemente... "+(0,d.zw)(e),1),(0,t.Wm)(r,{size:"2em",name:a?"las la-frown":"las la-exclamation-triangle"},null,8,["name"])])])),_:1},8,["columns","filter","loading","rows","title","onRequest","pagination"]),(0,t.Wm)(v,{modelValue:l.isEditVisible,"onUpdate:modelValue":a[2]||(a[2]=e=>l.isEditVisible=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{objeto:l.objeto,onChangeToggle:l.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,t.Wm)(v,{modelValue:l.isVisibleAgregar,"onUpdate:modelValue":a[3]||(a[3]=e=>l.isVisibleAgregar=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{objeto:l.objeto,onChangeToggle:l.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,t.Wm)(v,{modelValue:l.isVisibleMasivo,"onUpdate:modelValue":a[4]||(a[4]=e=>l.isVisibleMasivo=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{onChangeToggle:l.changeToggle},null,8,["onChangeToggle"])])),_:1},8,["modelValue"])],64)}o(71);const p={class:"row justify-center"};function v(e,a,o,s,n,r){const i=(0,t.up)("q-input"),c=(0,t.up)("q-btn"),u=(0,t.up)("q-form"),d=(0,t.up)("q-card");return(0,t.wg)(),(0,t.iD)("div",p,[(0,t.Wm)(d,{class:"q-pa-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{onSubmit:(0,l.iM)(s.axiosPut,["prevent"]),class:"q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{filled:"",label:"uid",modelValue:s.pObjeto.id,"onUpdate:modelValue":a[0]||(a[0]=e=>s.pObjeto.id=e),disable:"",valu:""},null,8,["modelValue"]),(0,t.Wm)(i,{filled:"",modelValue:s.pObjeto.nombre,"onUpdate:modelValue":a[1]||(a[1]=e=>s.pObjeto.nombre=e),label:"Nombre de categoria","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Debe ingresar un nombre para categoria",e=>e.length>=3&&e.length<20||"Debe ingresar un nombre entre 3 a 20 caracteres"]},null,8,["modelValue","rules"]),(0,t._)("div",null,[(0,t.Wm)(c,{label:"Editar",class:"full-width",type:"submit",color:s.colorButton,disable:s.bloqued},null,8,["color","disable"])])])),_:1},8,["onSubmit"])])),_:1})])}var b=o(8825);o(8669);const f=e=>{const a=(0,b.Z)(),o={headers:{"x-token":localStorage.token}},t=async()=>{try{await u.api.put(`categorias/${e.id}`,e,o).then((e=>{console.log(e.data.msg),200===e.status&&a.dialog({title:"Exito al actualizar",message:e.data.msg,cancel:!0})})).catch((e=>{console.log(e.response),401===e.response.status&&a.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&a.dialog({title:"Alerta de repetidos",message:e.response.data.msg})}))}catch(t){console.log(t)}},l=async(e="")=>{try{await u.api["delete"](`categorias/${e}`,o).then((e=>{console.log(e),200===e.status&&a.dialog({title:"Exito",message:e.data.msg})})).catch((e=>{console.log(e.response),401===e.response.status&&a.dialog({title:"Alerta de permisos",message:e.response.data.msg})}))}catch(t){console.log(t)}},s=async()=>{let t;try{await u.api.post("categorias",e.value,o).then((e=>{console.log(e),201===e.status&&(a.dialog({title:"Exito al agregar",message:`${e.data.nombre} se ha agregado con exito`}),t=e.data)})).catch((e=>{console.log(e.response),401===e.response.status&&a.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&a.dialog({title:"Alerta",message:e.response.data.msg})}));return t}catch(l){console.log(l)}};return{axiosPut:t,axiosDelete:l,axiosPost:s}},h=f,w={props:{objeto:{type:Object,required:!0}},setup(e){const{axiosPut:a}=h(e.objeto),o=(0,c.Fl)((()=>!e.objeto.nombre&&"disable")),t=(0,c.Fl)((()=>"disable"===o.value?"negative":"warning"));return{axiosPut:a,pObjeto:e.objeto,bloqued:o,colorButton:t}}};var C=o(4260),q=o(151),V=o(5269),y=o(4842),x=o(8240),W=o(7518),_=o.n(W);const k=(0,C.Z)(w,[["render",v]]),Z=k;_()(w,"components",{QCard:q.Z,QForm:V.Z,QInput:y.Z,QBtn:x.Z});const S={class:"row justify-center"},j=(0,t._)("div",{class:"text-h5 text-primary"},"Agregar categoria",-1);function P(e,a,o,s,n,r){const i=(0,t.up)("q-card-section"),c=(0,t.up)("q-input"),u=(0,t.up)("q-btn"),d=(0,t.up)("q-form"),g=(0,t.up)("q-card");return(0,t.wg)(),(0,t.iD)("div",S,[(0,t.Wm)(g,{class:"q-pa-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[j])),_:1}),(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Wm)(d,{onSubmit:(0,l.iM)(s.agregarCategoria,["prevent"]),class:"q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{filled:"",label:"Nombre de categoria",modelValue:s.categoria.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>s.categoria.nombre=e)},null,8,["modelValue"]),(0,t._)("div",null,[(0,t.Wm)(u,{disable:s.bloqued,label:"Agregar",class:"full-width",type:"submit",color:s.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const A={setup(){const e=(0,t.f3)("arrayRef"),a=(0,c.iH)({nombre:""}),{axiosPost:o}=h(a),l=()=>{let t=o().then((a=>{200!=a.status||e.value.push(a)})).catch((e=>{console.log(e)}));const l=e=>{};l(t),a.value.nombre=""},s=(0,c.Fl)((()=>!a.value.nombre&&"disable")),n=(0,c.Fl)((()=>"disable"===s.value?"negative":"secondary"));return{colorButton:n,bloqued:s,categoria:a,agregarCategoria:l}}};var Q=o(5589);const T=(0,C.Z)(A,[["render",P]]),H=T;_()(A,"components",{QCard:q.Z,QCardSection:Q.Z,QForm:V.Z,QInput:y.Z,QBtn:x.Z});var M=o(6305);const E={components:{dialogForm:Z,dialogFormCategoriaPOST:H,masivo:M.Z},props:{tittle:String,cols:Array},setup(e){const a=(0,t.f3)("arrayRef"),o=(0,t.f3)("isVisibleAgregar"),l=(0,t.f3)("isVisibleMasivo"),s=(0,b.Z)(),n=(0,c.iH)(!1),r=(0,c.iH)({}),i=(0,c.iH)(""),d=(0,c.iH)(!1),g=(0,c.iH)({page:1,rowsPerPage:1,rowsNumber:1}),m=async(e=0)=>{try{let e;const a={headers:{"x-token":localStorage.token},params:{pageSize:5}};await u.api.get("/categorias",a).then((e=>{const{meta:a,rows:o}=e.data;console.log(a),g.value.page=a.currentPage,g.value.rowsPerPage=a.pageSize,g.value.rowsNumber=a.count})).catch((e=>console.log(e.response)));return e}catch(a){console.log("Error en get",a)}};m();const p=async(e=0,o=5,t,l,s)=>{const n={headers:{"x-token":localStorage.token},params:{pageSize:o,currentPage:e}},r={headers:{"x-token":localStorage.token},params:{pageSize:o,currentPage:e,filter:t}},i={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:o,sorter:l,desc:s}};let c;c=""!==t?await u.api.get("/categorias",r):l?await u.api.get("/categorias",i):await u.api.get("/categorias",n);const{currentPage:m,pageSize:p,count:v}=c.data.meta,b=c.data.rows;a.value.splice(0,v,...b),g.value.page=m,g.value.rowsPerPage=p,g.value.rowsNumber=v,g.value.sortBy=l,g.value.descending=s,setInterval((()=>{d.value=!1}),1e3)};function v(e){d.value=!0;let a=e.filter.toUpperCase();p(e.pagination.page,e.pagination.rowsPerPage,a,e.pagination.sortBy,e.pagination.descending)}const{axiosDelete:f}=h(r),w="categorias/masivo";(0,t.JJ)("url",w);const C={nombre:{required:!0,label:"Nombre"}};return(0,t.JJ)("fields",C),{axiosDelete:f,categorias:a,filter:i,isEditVisible:n,isVisibleAgregar:o,isVisibleMasivo:l,loading:d,objeto:r,onRequest:v,pagination:g,changeToggle:e=>{n.value=e},editCategoria:e=>{n.value=!n.value,r.value=e.row},deleteCategoria:e=>{r.value=e.row,console.log(r.value),s.dialog({title:"Advertencia",message:`Está seguro de querer eliminar ${r.value.nombre}`,cancel:!0}).onOk((()=>{f(r.value.id),a.value=a.value.filter((e=>e.id!==r.value.id))}))}}}};var B=o(6429),D=o(4554),F=o(3884),z=o(6778);const R=(0,C.Z)(E,[["render",m]]),U=R;_()(E,"components",{QTable:B.Z,QInput:y.Z,QIcon:D.Z,QTd:F.Z,QBtn:x.Z,QDialog:z.Z});const I=[{name:"uid",label:"uid",field:"id",align:"left"},{name:"nombre",label:"Nombre categoria",field:"nombre",align:"left",sortable:!0},{name:"estado",label:"Estado categoria",field:"estado",align:"left"},{name:"actions",label:"Actions",field:"",align:"right"}],J={components:{tablaInventario:U},data(){const e=(0,c.iH)(!1),a=(0,c.iH)(!1);(0,t.JJ)("isVisibleAgregar",e),(0,t.JJ)("isVisibleMasivo",a);const o=(0,c.iH)([]),l=async()=>{try{const e={headers:{"x-token":localStorage.token}};await u.api.get("/categorias",e).then((e=>{const{meta:a,rows:t}=e.data;o.value=t}))}catch(e){console.log(e)}};l(),(0,t.JJ)("arrayRef",o);const s=()=>{e.value=!e.value},n=()=>{a.value=!a.value};return{cols:I,arrayRef:o,isVisibleAgregar:e,isVisibleMasivo:a,toggleAgregar:s,toggleMasivo:n}},methods:{onValidate(e){e.value=e}}};var O=o(4379);const N=(0,C.Z)(J,[["render",i]]),$=N;_()(J,"components",{QPage:O.Z,QBtn:x.Z})}}]);