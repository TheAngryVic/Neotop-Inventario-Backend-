"use strict";(self["webpackChunkfront_inventario"]=self["webpackChunkfront_inventario"]||[]).push([[893],{6305:(e,o,a)=>{a.d(o,{Z:()=>V});var l=a(3673),t=a(8880);const s=e=>((0,l.dD)("data-v-56b5c116"),e=e(),(0,l.Cn)(),e),r={id:"app"},n=s((()=>(0,l._)("h5",null,"Carga masiva",-1))),i={class:"row justify-center"};function u(e,o,a,s,u,c){const d=(0,l.up)("q-card-section"),g=(0,l.up)("q-btn"),p=(0,l.up)("vue-csv-toggle-headers"),m=(0,l.up)("vue-csv-errors"),b=(0,l.up)("vue-csv-input"),v=(0,l.up)("vue-csv-map"),w=(0,l.up)("vue-csv-import"),f=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(f,{style:{height:"600px","max-height":"80vh","max-width":"70vw"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[n])),_:1}),(0,l.Wm)(d,{class:"full-width column content-stretch"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{modelValue:s.csv,"onUpdate:modelValue":o[0]||(o[0]=e=>s.csv=e),fields:s.fields,text:s.texto},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((({hasHeaders:e,toggle:o})=>[(0,l._)("div",i,[(0,l.Wm)(g,{push:"",color:"white","text-color":1==e?"primary":"secondary",label:"Tiene cabecera?",icon:1==e?"las la-times":"las la-check ",onClick:(0,t.iM)(o,["prevent"]),class:"q-my-lg"},null,8,["text-color","icon","onClick"])])])),_:1}),(0,l.Wm)(m),(0,l.Wm)(b),(0,l.Wm)(v),(0,l._)("div",null,[(0,l.Wm)(g,{push:"",color:"white","text-color":"accent",label:"Procesar archivo",onClick:(0,t.iM)(s.procesar,["prevent"]),class:"q-my-lg",disable:s.bloquear},null,8,["onClick","disable"])])])),_:1},8,["modelValue","fields","text"])])),_:1})])),_:1})])}var c=a(1959),d=a(8825),g=a(3739),p=a(5474);const m={components:{VueCsvToggleHeaders:g.H_,VueCsvMap:g.qH,VueCsvInput:g.hX,VueCsvErrors:g.v7,VueCsvImport:g.xD},setup(){const e=(0,d.Z)(),o={headers:{"x-token":localStorage.token}},a=(0,c.iH)(null),t=(0,l.f3)("url"),s=(0,l.f3)("fields"),r=(0,l.f3)("nserie"),n={errors:{fileRequired:"Un archivo es requerido",invalidMimeType:"Tipo de archivo invalido"},toggleHeaders:"Cabecera?   ",submitBtn:"Procesar",fieldColumn:"Campo",csvColumn:"Columna"},i=async()=>{if(r){const o=a.value.reduce(((e,o)=>(e[o.nSerie]=++e[o.nSerie]||0,e)),{}),l=a.value.filter((e=>o[e.nSerie]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nSerie}`})}else{const o=a.value.reduce(((e,o)=>(e[o.nombre]=++e[o.nombre]||0,e)),{});console.log(o);const l=a.value.filter((e=>o[e.nombre]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nombre}`})}await p.api.post(t,a,o).then((o=>{console.log(o),200!=o.status||e.dialog({title:"Exito",message:"Los datos se han cargado con exito "})})).catch((o=>{console.log("Catch ->",o),o&&e.dialog({title:"Error",message:"El archivo tiene datos que no corresponden, por favor revise datos"})}))},u=(0,c.Fl)((()=>null!=a.value?"true":""));return{bloquear:u,csv:a,fields:s,options:o,procesar:i,texto:n}}};var b=a(4260),v=a(151),w=a(5589),f=a(8240),h=a(7518),_=a.n(h);const y=(0,b.Z)(m,[["render",u],["__scopeId","data-v-56b5c116"]]),V=y;_()(m,"components",{QCard:v.Z,QCardSection:w.Z,QBtn:f.Z})},5893:(e,o,a)=>{a.r(o),a.d(o,{default:()=>ee});var l=a(3673),t=a(8880);const s=(0,l._)("div",{class:"row justify-center"},[(0,l._)("h3",null,"Administración de usuarios")],-1),r={class:"row xs-12 md-9 justify-center"},n={class:"row justify-center q-mt-md"};function i(e,o,a,i,u,c){const d=(0,l.up)("tabla"),g=(0,l.up)("q-btn"),p=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(p,{class:"q-p2"},{default:(0,l.w5)((()=>[s,(0,l._)("div",r,[(0,l.Wm)(d,{cols:u.cols,tittle:"Listado de usuarios"},null,8,["cols"])]),(0,l._)("div",n,[(0,l.Wm)(g,{color:"secondary",icon:"las la-check",label:"Agregar",onClick:(0,t.iM)(u.toggleAgregar,["prevent"])},null,8,["onClick"])])])),_:1})}var u=a(1959),c=a(5474),d=a(2323);const g={class:"full-width row flex-center text-accent q-gutter-sm"};function p(e,o,a,t,s,r){const n=(0,l.up)("q-icon"),i=(0,l.up)("q-input"),u=(0,l.up)("q-td"),c=(0,l.up)("q-btn"),p=(0,l.up)("q-table"),m=(0,l.up)("agregarUsuario"),b=(0,l.up)("q-dialog"),v=(0,l.up)("editarUsuario"),w=(0,l.up)("masivo");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(p,{columns:a.cols,filter:t.filter,loading:t.loading,"rows-per-page-options":[5,8,10],rows:t.usuario,title:a.tittle,onRequest:t.onRequest,"card-class":"bg-red-1 text-grey-9",class:"q-mt-xl",color:"primary","row-key":"id","rows-per-page-label":"Filas por página",pagination:t.pagination,"onUpdate:pagination":o[1]||(o[1]=e=>t.pagination=e),"binary-state-sort":""},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(i,{modelValue:t.filter,"onUpdate:modelValue":o[0]||(o[0]=e=>t.filter=e),rounded:"",outlined:"",debounce:"300",placeholder:"buscador","bg-color":"white"},{append:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"las la-search"})])),_:1},8,["modelValue"])])),"body-cell-Id":(0,l.w5)((e=>[(0,l.Wm)(u,{key:"Id",props:e,class:(0,d.C_)(e.row.estado?"bg-green-7 text-white":"bg-red-6 text-white")},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.row.id),1)])),_:2},1032,["props","class"])])),"body-cell-Nombre":(0,l.w5)((e=>[(0,l.Wm)(u,{key:"Id",props:e,class:(0,d.C_)(e.row.estado?"bg-green-7 text-white":"bg-red-6 text-white")},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.row.nombre),1)])),_:2},1032,["props","class"])])),"body-cell-Correo":(0,l.w5)((e=>[(0,l.Wm)(u,{key:"Id",props:e,class:(0,d.C_)(e.row.estado?"bg-green-7 text-white":"bg-red-6 text-white")},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.row.correo),1)])),_:2},1032,["props","class"])])),"body-cell-Rol":(0,l.w5)((e=>[(0,l.Wm)(u,{key:"Id",props:e,class:(0,d.C_)(e.row.estado?"bg-green-7 text-white":"bg-red-6 text-white")},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.row.Rol.nombre),1)])),_:2},1032,["props","class"])])),"body-cell-actions":(0,l.w5)((e=>[(0,l.Wm)(u,{props:e,class:(0,d.C_)(e.row.estado?"bg-green-7 text-white":"bg-red-6 text-white")},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{dense:"",round:"",flat:"",color:"orange-13",onClick:o=>t.editarBodega(e),icon:"las la-edit"},null,8,["onClick"]),(0,l.Wm)(c,{dense:"",round:"",flat:"",color:e.row.estado?"red-14":"green-14",onClick:o=>t.deleteBodega(e),icon:e.row.estado?"las la-trash":"las la-plus-circle"},null,8,["color","onClick","icon"])])),_:2},1032,["props","class"])])),"no-data":(0,l.w5)((({message:e,filter:o})=>[(0,l._)("div",g,[(0,l.Wm)(n,{size:"2em",name:"las la-meh"}),(0,l._)("span",null," Lamentablemente... "+(0,d.zw)(e),1),(0,l.Wm)(n,{size:"2em",name:o?"las la-frown":"las la-exclamation-triangle"},null,8,["name"])])])),_:1},8,["columns","filter","loading","rows","title","onRequest","pagination"]),(0,l.Wm)(b,{modelValue:t.isVisibleAgregar,"onUpdate:modelValue":o[2]||(o[2]=e=>t.isVisibleAgregar=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isEditVisible,"onUpdate:modelValue":o[3]||(o[3]=e=>t.isEditVisible=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isVisibleMasivo,"onUpdate:modelValue":o[4]||(o[4]=e=>t.isVisibleMasivo=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{onChangeToggle:t.changeToggle},null,8,["onChangeToggle"])])),_:1},8,["modelValue"])],64)}a(71);var m=a(8825);a(8669);const b=e=>{const o=(0,m.Z)(),a={headers:{"x-token":localStorage.token}},l=async()=>{let o;try{await c.api.put(`usuarios/${e.id}`,e,a).then((e=>{o=e}))}catch(l){console.log(l)}return o},t=async(e="")=>{try{await c.api["delete"](`usuarios/${e}`,a).then((e=>{console.log(e),200===e.status&&o.dialog({title:"Exito",message:"Eliminado con exito"})})).catch((e=>{console.log(e.response),401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.msg})}))}catch(l){console.log(l)}},s=async()=>{let l;try{await c.api.post("usuarios",e.value,a).then((e=>{console.log(e),201===e.status&&(o.dialog({title:"Exito al agregar",message:e.data.msg}),l=e.data.respuesta)})).catch((e=>{401===e.response.status&&o.dialog({title:"Alerta de permisos",message:e.response.data.errors[0].msg}),400===e.response.status&&o.dialog({title:"Alerta",message:e.response.data.errors[0].msg})}));return l}catch(t){console.log(t)}};return{axiosPut:l,axiosDelete:t,axiosPost:s}},v=b;var w=a(6305);const f={class:"row justify-center"},h=(0,l._)("div",{class:"text-h5 text-primary"},"Agregar usuario",-1),_=(0,l.Uk)(" No results ");function y(e,o,a,s,r,n){const i=(0,l.up)("q-card-section"),u=(0,l.up)("q-input"),c=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),g=(0,l.up)("q-select"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(b,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[h])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{onSubmit:(0,t.iM)(s.agregarUsuario,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{filled:"",label:"Nombre",modelValue:s.usuario.nombre,"onUpdate:modelValue":o[0]||(o[0]=e=>s.usuario.nombre=e)},null,8,["modelValue"]),(0,l.Wm)(u,{filled:"",type:"email",label:"Email",modelValue:s.usuario.correo,"onUpdate:modelValue":o[1]||(o[1]=e=>s.usuario.correo=e)},null,8,["modelValue"]),(0,l.Wm)(u,{filled:"",type:"password",rules:[e=>!!e||"* Required",e=>e.length>=6||"Minimo 6 caracteres"],"lazy-rules":"",label:"Contraseña",modelValue:s.usuario.password,"onUpdate:modelValue":o[2]||(o[2]=e=>s.usuario.password=e)},null,8,["rules","modelValue"]),(0,l.Wm)(g,{filled:"",modelValue:s.usuario.rol,"onUpdate:modelValue":o[3]||(o[3]=e=>s.usuario.rol=e),options:s.roles,label:"Rol",style:{width:"250px"},hint:"Seleccione un rol","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"text-grey"},{default:(0,l.w5)((()=>[_])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l._)("div",null,[(0,l.Wm)(p,{disable:s.bloqued,label:"Agregar",class:"full-width",type:"submit",color:s.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const V={setup(){const e=(0,l.f3)("usersArray"),o=(0,u.iH)({nombre:"",correo:"",password:"",rol:""}),a=[{label:"ADMIN",value:"ADMIN_ROLE"},{label:"BODEGA",value:"BODEGA_ROLE"},{label:"SERVICIO TECNICO",value:"SERVICIO_ROLE"},{label:"NORMAL",value:"USER_ROLE"}],{axiosPost:t}=v(o),s=()=>{t().then((o=>{200!=o.status||e.value.push(o)}));o.value={nombre:"",correo:"",password:"",rol:""}},r=(0,u.Fl)((()=>!(o.value.nombre&&o.value.correo&&o.value.password&&o.value.rol)&&"disable")),n=(0,u.Fl)((()=>"disable"===r.value?"negative":"secondary"));return{agregarUsuario:s,bloqued:r,colorButton:n,roles:a,usuario:o}}};var q=a(4260),C=a(151),x=a(5589),W=a(5269),k=a(4842),S=a(8516),Z=a(3414),R=a(2035),E=a(8240),A=a(7518),I=a.n(A);const U=(0,q.Z)(V,[["render",y]]),j=U;I()(V,"components",{QCard:C.Z,QCardSection:x.Z,QForm:W.Z,QInput:k.Z,QSelect:S.Z,QItem:Z.Z,QItemSection:R.Z,QBtn:E.Z});const O={class:"row justify-center"},Q=(0,l._)("div",{class:"text-h5 text-warning"},"Modificar Usuario",-1),B=(0,l.Uk)(" No results ");function M(e,o,a,s,r,n){const i=(0,l.up)("q-card-section"),u=(0,l.up)("q-input"),c=(0,l.up)("q-item-section"),d=(0,l.up)("q-item"),g=(0,l.up)("q-select"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-form"),b=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",O,[(0,l.Wm)(b,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[Q])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{onSubmit:(0,t.iM)(s.procesar,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{filled:"",label:"Nombre",modelValue:s.pObjeto.nombre,"onUpdate:modelValue":o[0]||(o[0]=e=>s.pObjeto.nombre=e)},null,8,["modelValue"]),(0,l.Wm)(u,{filled:"",type:"password",label:"Contraseña",modelValue:s.pass,"onUpdate:modelValue":o[1]||(o[1]=e=>s.pass=e),rules:[e=>!!e||"* Required",e=>e.length>=6||"Minimo 6 caracteres"],"lazy-rules":""},null,8,["modelValue","rules"]),(0,l.Wm)(g,{filled:"",modelValue:s.pObjeto.Rol.nombre,"onUpdate:modelValue":o[2]||(o[2]=e=>s.pObjeto.Rol.nombre=e),options:s.roles,label:"Rol",style:{width:"250px"},hint:"Seleccione un rol","emit-value":"","map-options":""},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"text-grey"},{default:(0,l.w5)((()=>[B])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,l._)("div",null,[(0,l.Wm)(p,{disable:s.bloqued,label:"modificar",class:"full-width",type:"submit",color:s.colorButton},null,8,["disable","color"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const P={props:{objeto:{type:Object,required:!0}},setup(e){const o=(0,m.Z)();console.log(e.objeto);const a=[{label:"ADMIN",value:"ADMIN_ROLE"},{label:"BODEGA",value:"BODEGA_ROLE"},{label:"SERVICIO TECNICO",value:"SERVICIO_ROLE"},{label:"NORMAL",value:"USER_ROLE"}];let l=(0,u.iH)(""),t=(0,u.iH)({id:"",nombre:"",password:"",rol:""}),s=async()=>{t.value={id:e.objeto.id,nombre:e.objeto.nombre,password:l.value,rol:e.objeto.Rol.nombre};const{axiosPut:a}=v(t.value);let s=await a();200==s.status&&o.dialog({title:"Exito al actualizar",message:s.data.msg})};const r=(0,u.Fl)((()=>!(e.objeto.nombre&&e.objeto.correo&&l.value&&e.objeto.Rol)&&"disable")),n=(0,u.Fl)((()=>"disable"===r.value?"negative":"warning"));return{pObjeto:e.objeto,bloqued:r,colorButton:n,roles:a,data:t,procesar:s,pass:l}}},T=(0,q.Z)(P,[["render",M]]),H=T;I()(P,"components",{QCard:C.Z,QCardSection:x.Z,QForm:W.Z,QInput:k.Z,QSelect:S.Z,QItem:Z.Z,QItemSection:R.Z,QBtn:E.Z});const N={components:{agregarUsuario:j,editarUsuario:H,masivo:w.Z},props:{tittle:String,cols:Array},setup(e){const o=(0,l.f3)("usersArray"),a=(0,l.f3)("isVisibleAgregar"),t=(0,m.Z)(),s=(0,u.iH)(!1),r=(0,u.iH)({}),n=(0,u.iH)(""),i=(0,u.iH)(!1),d=(0,u.iH)({page:1,rowsPerPage:1,rowsNumber:1}),g=async(e=0)=>{try{let e;const o={headers:{"x-token":localStorage.token},params:{pageSize:5}};await c.api.get("/usuarios",o).then((e=>{const{meta:o,rows:a}=e.data;console.log(o),d.value.page=o.currentPage,d.value.rowsPerPage=o.pageSize,d.value.rowsNumber=o.count})).catch((e=>console.log(e.response)));return e}catch(o){console.log("Error en get",o)}};g();const p=async(e=0,a=5,l,t,s)=>{const r={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a}},n={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,filter:l}},u={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:a,sorter:t,desc:s}};let g;g=""!==l?await c.api.get("/usuarios",n):t?await c.api.get("/usuarios",u):await c.api.get("/usuarios",r);const{currentPage:p,pageSize:m,count:b}=g.data.meta,v=g.data.rows;o.value.splice(0,b,...v),d.value.page=p,d.value.rowsPerPage=m,d.value.rowsNumber=b,d.value.sortBy=t,d.value.descending=s,setInterval((()=>{i.value=!1}),1e3)};function b(e){i.value=!0;let o=e.filter.toUpperCase();p(e.pagination.page,e.pagination.rowsPerPage,o,e.pagination.sortBy,e.pagination.descending)}const{axiosDelete:w}=v(e.objeto),f=(0,l.f3)("isVisibleMasivo"),h="usuario/masivo";(0,l.JJ)("url",h);const _={nombre:{required:!0,label:"Nombre"},local:{required:!0,label:"Ubicación"}};return(0,l.JJ)("fields",_),{axiosDelete:w,usuario:o,filter:n,isEditVisible:s,isVisibleMasivo:f,isVisibleAgregar:a,loading:i,objeto:r,onRequest:b,pagination:d,changeToggle:e=>{s.value=e},editarBodega:e=>{s.value=!s.value,console.log(e.row),r.value=e.row},deleteBodega:e=>{r.value=e.row,console.log(r.value),t.dialog({title:"Advertencia",message:`Está seguro de querer eliminar ${r.value.nombre}`,cancel:!0}).onOk((()=>{w(r.value.id),o.value=o.value.filter((e=>e.id!==r.value.id))}))}}}};var D=a(6429),z=a(4554),L=a(3884),J=a(6778);const F=(0,q.Z)(N,[["render",p]]),$=F;I()(N,"components",{QTable:D.Z,QInput:k.Z,QIcon:z.Z,QTd:L.Z,QBtn:E.Z,QDialog:J.Z});const G=[{name:"Id",label:"uid",field:"id",align:"left"},{name:"Nombre",label:"Nombre",field:"nombre",align:"left",sortable:!0},{name:"Correo",label:"Correo",field:"correo",align:"left"},{name:"Rol",label:"Rol",field:e=>e.Rol.nombre,align:"left"},{name:"actions",label:"Actions",field:"",align:"right"}],X={components:{tabla:$},data(){const e=(0,u.iH)(!1);(0,u.iH)(!1);(0,l.JJ)("isVisibleAgregar",e);const o=(0,u.iH)([]),a=(0,u.iH)([]);const t=async(e=0)=>{try{const e={headers:{"x-token":localStorage.token},params:{pageSize:5}},l=await c.api.get("/usuarios",e).then((e=>{const{meta:l,rows:t}=e.data;console.log(t),console.log(l),o.value=t,a.value=l[0]})).catch((e=>console.log(e.response)));return l}catch(l){console.log("Error en get",l)}};t(),(0,l.JJ)("usersArray",o),(0,l.JJ)("metaInfo",a),console.log(a.value);const s=()=>{e.value=!e.value};return{cols:G,usersArray:o,isVisibleAgregar:e,toggleAgregar:s}}};var Y=a(4379);const K=(0,q.Z)(X,[["render",i]]),ee=K;I()(X,"components",{QPage:Y.Z,QBtn:E.Z})}}]);