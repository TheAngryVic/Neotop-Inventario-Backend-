"use strict";(self["webpackChunkfront_inventario"]=self["webpackChunkfront_inventario"]||[]).push([[922],{6305:(e,a,o)=>{o.d(a,{Z:()=>y});var l=o(3673),t=o(8880);const s=e=>((0,l.dD)("data-v-56b5c116"),e=e(),(0,l.Cn)(),e),n={id:"app"},r=s((()=>(0,l._)("h5",null,"Carga masiva",-1))),i={class:"row justify-center"};function c(e,a,o,s,c,d){const u=(0,l.up)("q-card-section"),g=(0,l.up)("q-btn"),m=(0,l.up)("vue-csv-toggle-headers"),p=(0,l.up)("vue-csv-errors"),b=(0,l.up)("vue-csv-input"),v=(0,l.up)("vue-csv-map"),f=(0,l.up)("vue-csv-import"),h=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(h,{style:{height:"600px","max-height":"80vh","max-width":"70vw"}},{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[r])),_:1}),(0,l.Wm)(u,{class:"full-width column content-stretch"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:s.csv,"onUpdate:modelValue":a[0]||(a[0]=e=>s.csv=e),fields:s.fields,text:s.texto},{default:(0,l.w5)((()=>[(0,l.Wm)(m,null,{default:(0,l.w5)((({hasHeaders:e,toggle:a})=>[(0,l._)("div",i,[(0,l.Wm)(g,{push:"",color:"white","text-color":1==e?"primary":"secondary",label:"Tiene cabecera?",icon:1==e?"las la-times":"las la-check ",onClick:(0,t.iM)(a,["prevent"]),class:"q-my-lg"},null,8,["text-color","icon","onClick"])])])),_:1}),(0,l.Wm)(p),(0,l.Wm)(b),(0,l.Wm)(v),(0,l._)("div",null,[(0,l.Wm)(g,{push:"",color:"white","text-color":"accent",label:"Procesar archivo",onClick:(0,t.iM)(s.procesar,["prevent"]),class:"q-my-lg",disable:s.bloquear},null,8,["onClick","disable"])])])),_:1},8,["modelValue","fields","text"])])),_:1})])),_:1})])}var d=o(1959),u=o(8825),g=o(3739),m=o(5474);const p={components:{VueCsvToggleHeaders:g.H_,VueCsvMap:g.qH,VueCsvInput:g.hX,VueCsvErrors:g.v7,VueCsvImport:g.xD},setup(){const e=(0,u.Z)(),a={headers:{"x-token":localStorage.token}},o=(0,d.iH)(null),t=(0,l.f3)("url"),s=(0,l.f3)("fields"),n=(0,l.f3)("nserie"),r={errors:{fileRequired:"Un archivo es requerido",invalidMimeType:"Tipo de archivo invalido"},toggleHeaders:"Cabecera?   ",submitBtn:"Procesar",fieldColumn:"Campo",csvColumn:"Columna"},i=async()=>{if(n){const a=o.value.reduce(((e,a)=>(e[a.nSerie]=++e[a.nSerie]||0,e)),{}),l=o.value.filter((e=>a[e.nSerie]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nSerie}`})}else{const a=o.value.reduce(((e,a)=>(e[a.nombre]=++e[a.nombre]||0,e)),{});console.log(a);const l=o.value.filter((e=>a[e.nombre]));if(console.log("Repetidos",l),l.length>0)return void e.dialog({title:"Advertencia",message:`Tiene datos repetidos: ${l[0].nombre}`})}await m.api.post(t,o,a).then((a=>{console.log(a),200!=a.status||e.dialog({title:"Exito",message:"Los datos se han cargado con exito "})})).catch((a=>{console.log("Catch ->",a),a&&e.dialog({title:"Error",message:"El archivo tiene datos que no corresponden, por favor revise datos"})}))},c=(0,d.Fl)((()=>null!=o.value?"true":""));return{bloquear:c,csv:o,fields:s,options:a,procesar:i,texto:r}}};var b=o(4260),v=o(151),f=o(5589),h=o(8240),w=o(7518),V=o.n(w);const q=(0,b.Z)(p,[["render",c],["__scopeId","data-v-56b5c116"]]),y=q;V()(p,"components",{QCard:v.Z,QCardSection:f.Z,QBtn:h.Z})},9922:(e,a,o)=>{o.r(a),o.d(a,{default:()=>L});var l=o(3673),t=o(8880);const s=(0,l._)("div",{class:"row justify-center"},[(0,l._)("h3",null,"Bodegas")],-1),n={class:"row xs-12 md-9 justify-center"},r={class:"row justify-center q-mt-md"};function i(e,a,o,i,c,d){const u=(0,l.up)("tabla"),g=(0,l.up)("q-btn"),m=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(m,{class:"q-p2"},{default:(0,l.w5)((()=>[s,(0,l._)("div",n,[(0,l.Wm)(u,{cols:c.cols,tittle:"Listado de bodegas"},null,8,["cols"])]),(0,l._)("div",r,[(0,l.Wm)(g,{color:"secondary",icon:"las la-check",label:"Agregar",onClick:(0,t.iM)(c.toggleAgregar,["prevent"])},null,8,["onClick"]),(0,l.Wm)(g,{color:"accent",icon:"las la-paperclip",label:"Carga masiva",onClick:(0,t.iM)(c.toggleMasivo,["prevent"]),class:"q-mx-md"},null,8,["onClick"])])])),_:1})}var c=o(1959),d=o(5474),u=o(2323);const g={class:"full-width row flex-center text-accent q-gutter-sm"};function m(e,a,o,t,s,n){const r=(0,l.up)("q-icon"),i=(0,l.up)("q-input"),c=(0,l.up)("q-btn"),d=(0,l.up)("q-td"),m=(0,l.up)("q-table"),p=(0,l.up)("agregarBodega"),b=(0,l.up)("q-dialog"),v=(0,l.up)("editarBodega"),f=(0,l.up)("masivo");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(m,{columns:o.cols,filter:t.filter,loading:t.loading,"rows-per-page-options":[5,8,10],rows:t.bodegas,title:o.tittle,onRequest:t.onRequest,"card-class":"bg-red-1 text-grey-9",class:"q-mt-xl",color:"primary","row-key":"id","rows-per-page-label":"Filas por página",pagination:t.pagination,"onUpdate:pagination":a[1]||(a[1]=e=>t.pagination=e),"binary-state-sort":""},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(i,{modelValue:t.filter,"onUpdate:modelValue":a[0]||(a[0]=e=>t.filter=e),rounded:"",outlined:"",debounce:"300",placeholder:"buscador","bg-color":"white"},{append:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"las la-search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,l.w5)((e=>[(0,l.Wm)(d,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{dense:"",round:"",flat:"",color:"orange-13",onClick:a=>t.editarBodega(e),icon:"las la-edit"},null,8,["onClick"]),(0,l.Wm)(c,{dense:"",round:"",flat:"",color:"red-14",onClick:a=>t.deleteBodega(e),icon:"las la-trash"},null,8,["onClick"])])),_:2},1032,["props"])])),"no-data":(0,l.w5)((({message:e,filter:a})=>[(0,l._)("div",g,[(0,l.Wm)(r,{size:"2em",name:"las la-meh"}),(0,l._)("span",null," Lamentablemente... "+(0,u.zw)(e),1),(0,l.Wm)(r,{size:"2em",name:a?"las la-frown":"las la-exclamation-triangle"},null,8,["name"])])])),_:1},8,["columns","filter","loading","rows","title","onRequest","pagination"]),(0,l.Wm)(b,{modelValue:t.isVisibleAgregar,"onUpdate:modelValue":a[2]||(a[2]=e=>t.isVisibleAgregar=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isEditVisible,"onUpdate:modelValue":a[3]||(a[3]=e=>t.isEditVisible=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{objeto:t.objeto,onChangeToggle:t.changeToggle},null,8,["objeto","onChangeToggle"])])),_:1},8,["modelValue"]),(0,l.Wm)(b,{modelValue:t.isVisibleMasivo,"onUpdate:modelValue":a[4]||(a[4]=e=>t.isVisibleMasivo=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{onChangeToggle:t.changeToggle},null,8,["onChangeToggle"])])),_:1},8,["modelValue"])],64)}o(71);var p=o(8825);o(8669);const b=e=>{const a=(0,p.Z)(),o={headers:{"x-token":localStorage.token}},l=async()=>{try{console.log(e.id);await d.api.put(`bodegas/${e.id}`,e,o).then((e=>{console.log(e.data.msg),200===e.status&&a.dialog({title:"Exito al actualizar",message:e.data.msg,cancel:!0})})).catch((e=>{401===e.response.status&&a.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&a.dialog({title:"Alerta de repetidos",message:e.response.data.msg})}))}catch(l){console.log(l)}},t=async(e="")=>{try{await d.api["delete"](`bodegas/${e}`,o).then((e=>{console.log(e),200===e.status&&a.dialog({title:"Exito",message:e.data.msg})})).catch((e=>{console.log(e.response),401===e.response.status&&a.dialog({title:"Alerta de permisos",message:e.response.data.msg})}))}catch(l){console.log(l)}},s=async()=>{let l;try{await d.api.post("bodegas",e.value,o).then((e=>{201===e.status&&(a.dialog({title:"Exito al agregar",message:`${e.data.nombre} se ha agregado con exito`}),l=e.data)})).catch((e=>{console.log(e.response),401===e.response.status&&a.dialog({title:"Alerta de permisos",message:e.response.data.msg}),400===e.response.status&&a.dialog({title:"Alerta",message:e.response.data.msg})}));return l}catch(t){console.log(t)}};return{axiosPut:l,axiosDelete:t,axiosPost:s}},v=b;var f=o(6305);const h={class:"row justify-center"},w=(0,l._)("div",{class:"text-h5 text-primary"},"Agregar bodega",-1);function V(e,a,o,s,n,r){const i=(0,l.up)("q-card-section"),c=(0,l.up)("q-input"),d=(0,l.up)("q-btn"),u=(0,l.up)("q-form"),g=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",h,[(0,l.Wm)(g,{class:"q-pa-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{onSubmit:(0,t.iM)(s.agregarBodega,["prevent"]),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{filled:"",label:"Nombre de bodega",modelValue:s.bodega.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>s.bodega.nombre=e)},null,8,["modelValue"]),(0,l.Wm)(c,{filled:"",label:"Localización",modelValue:s.bodega.local,"onUpdate:modelValue":a[1]||(a[1]=e=>s.bodega.local=e)},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(d,{label:"Agregar",class:"full-width",type:"submit",color:"secondary"})])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])}const q={setup(){const e=(0,l.f3)("bodegasArray"),a=(0,c.iH)({nombre:"",local:""}),{axiosPost:o}=v(a),t=()=>{o().then((a=>{200!=a.status||e.value.push(a)})).catch((e=>console.log(e)));a.value={nombre:"",local:""}};return{bodega:a,agregarBodega:t}}};var y=o(4260),x=o(151),C=o(5589),W=o(5269),k=o(4842),_=o(8240),Z=o(7518),j=o.n(Z);const A=(0,y.Z)(q,[["render",V]]),S=A;j()(q,"components",{QCard:x.Z,QCardSection:C.Z,QForm:W.Z,QInput:k.Z,QBtn:_.Z});const P={class:"row justify-center"};function B(e,a,o,s,n,r){const i=(0,l.up)("q-input"),c=(0,l.up)("q-btn"),d=(0,l.up)("q-form"),u=(0,l.up)("q-card");return(0,l.wg)(),(0,l.iD)("div",P,[(0,l.Wm)(u,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{onSubmit:a[3]||(a[3]=(0,t.iM)((e=>s.axiosPut()),["prevent"])),class:"q-gutter-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{filled:"",label:"uid",modelValue:s.pObjeto.id,"onUpdate:modelValue":a[0]||(a[0]=e=>s.pObjeto.id=e),disable:"",valu:""},null,8,["modelValue"]),(0,l.Wm)(i,{filled:"",modelValue:s.pObjeto.nombre,"onUpdate:modelValue":a[1]||(a[1]=e=>s.pObjeto.nombre=e),label:"Nombre de bodega","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Debe ingresar un nombre para la bodega",e=>e.length>=3&&e.length<20||"Debe ingresar un nombre entre 3 a 20 caracteres"]},null,8,["modelValue","rules"]),(0,l.Wm)(i,{filled:"",modelValue:s.pObjeto.local,"onUpdate:modelValue":a[2]||(a[2]=e=>s.pObjeto.local=e),label:"Localización","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Debe ingresar una localización",e=>e.length>=3&&e.length<20||"Debe ingresar un nombre entre 3 a 20 caracteres"]},null,8,["modelValue","rules"]),(0,l._)("div",null,[(0,l.Wm)(c,{label:"Editar",class:"full-width",type:"submit",color:s.colorButton,disable:s.bloqued},null,8,["color","disable"])])])),_:1})])),_:1})])}const Q={props:{objeto:{type:Object,required:!0}},setup(e){const{axiosPut:a}=v(e.objeto),o=(0,c.Fl)((()=>(!e.objeto.nombre||!e.objeto.local)&&"disable")),l=(0,c.Fl)((()=>"disable"===o.value?"negative":"warning"));return{axiosPut:a,pObjeto:e.objeto,bloqued:o,colorButton:l}}},T=(0,y.Z)(Q,[["render",B]]),z=T;j()(Q,"components",{QCard:x.Z,QForm:W.Z,QInput:k.Z,QBtn:_.Z});const H={components:{agregarBodega:S,editarBodega:z,masivo:f.Z},props:{tittle:String,cols:Array},setup(e){const a=(0,l.f3)("bodegasArray"),o=(0,l.f3)("isVisibleAgregar"),t=(0,p.Z)(),s=(0,c.iH)(!1),n=(0,c.iH)({}),r=(0,c.iH)(""),i=(0,c.iH)(!1),u=(0,c.iH)({page:1,rowsPerPage:1,rowsNumber:1}),g=async(e=1)=>{try{let e;const a={headers:{"x-token":localStorage.token},params:{pageSize:5}};await d.api.get("/bodegas",a).then((e=>{const{meta:a,rows:o}=e.data;console.log(a),u.value.page=a.currentPage,u.value.rowsPerPage=a.pageSize,u.value.rowsNumber=a.count})).catch((e=>console.log(e.response)));return e}catch(a){console.log("Error en get",a)}};g();const m=async(e=0,o=5,l,t,s)=>{const n={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:o}},r={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:o,filter:l}},c={headers:{"x-token":localStorage.token},params:{currentPage:e,pageSize:o,sorter:t,desc:s}};let g;g=""!==l?await d.api.get("/bodegas",r):t?await d.api.get("/bodegas",c):await d.api.get("/bodegas",n);const{currentPage:m,pageSize:p,count:b}=g.data.meta,v=g.data.rows;a.value.splice(0,b,...v),u.value.page=m,u.value.rowsPerPage=p,u.value.rowsNumber=b,u.value.sortBy=t,u.value.descending=s,setInterval((()=>{i.value=!1}),1e3)};function b(e){i.value=!0;let a=e.filter.toUpperCase();m(e.pagination.page,e.pagination.rowsPerPage,a,e.pagination.sortBy,e.pagination.descending)}const{axiosDelete:f}=v(e.objeto),h=(0,l.f3)("isVisibleMasivo"),w="bodegas/masivo";(0,l.JJ)("url",w);const V={nombre:{required:!0,label:"Nombre"},local:{required:!0,label:"Ubicación"}};return(0,l.JJ)("fields",V),{axiosDelete:f,bodegas:a,filter:r,isEditVisible:s,isVisibleMasivo:h,isVisibleAgregar:o,loading:i,objeto:n,onRequest:b,pagination:u,changeToggle:e=>{s.value=e},editarBodega:e=>{s.value=!s.value,n.value=e.row},deleteBodega:e=>{n.value=e.row,t.dialog({title:"Advertencia",message:`Está seguro de querer eliminar ${n.value.nombre}`,cancel:!0}).onOk((()=>{f(n.value.id),a.value=a.value.filter((e=>e.id!==n.value.id)),console.log("ok")}))}}}};var E=o(6429),M=o(4554),D=o(3884),U=o(6778);const J=(0,y.Z)(H,[["render",m]]),O=J;j()(H,"components",{QTable:E.Z,QInput:k.Z,QIcon:M.Z,QTd:D.Z,QBtn:_.Z,QDialog:U.Z});const I=[{name:"uid",label:"uid",field:"id",align:"left"},{name:"nombre",label:"Nombre bodega",field:"nombre",align:"left",sortable:!0},{name:"estado",label:"Estado categoria",field:"estado",align:"left"},{name:"local",label:"Lugar",field:"local",align:"left",sortable:!0},{name:"actions",label:"Actions",field:"",align:"right"}],N={components:{tabla:O},data(){const e=(0,c.iH)(!1),a=(0,c.iH)(!1);(0,l.JJ)("isVisibleAgregar",e),(0,l.JJ)("isVisibleMasivo",a);const o=(0,c.iH)([]),t=async(e=0)=>{try{const e={headers:{"x-token":localStorage.token},params:{pageSize:5}};await d.api.get("/bodegas",e).then((e=>{const{meta:a,rows:l}=e.data;o.value=l})).catch((e=>console.log(e.response)))}catch(a){console.log("Error en get",a)}};t(),(0,l.JJ)("bodegasArray",o);const s=()=>{e.value=!e.value},n=()=>{a.value=!a.value};return{cols:I,bodegasArray:o,isVisibleAgregar:e,toggleAgregar:s,toggleMasivo:n}}};var R=o(4379);const F=(0,y.Z)(N,[["render",i]]),L=F;j()(N,"components",{QPage:R.Z,QBtn:_.Z})}}]);